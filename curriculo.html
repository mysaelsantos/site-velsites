<!DOCTYPE html>
<html lang="pt-PT">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Currículo Gratuito - Crie seu CV Profissional</title>
    <!-- Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <!-- jsPDF e html2canvas para exportar PDF --><script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <!-- ADICIONADO: Biblioteca QR Code --><script src="https://cdnjs.cloudflare.com/ajax/libs/qrcode/1.5.1/qrcode.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');

        :root {
            --theme-color: #002e9e; /* Cor primária do Vel Sites */
            --cor-primaria: #002e9e;
            --cor-secundaria: #0078e8;
            --gradiente-texto: linear-gradient(135deg, var(--cor-primaria), var(--cor-secundaria));
        }

        body {
            font-family: 'Poppins', sans-serif;
            -webkit-print-color-adjust: exact;
            background-color: #f9fafb; /* Fundo cinza claro igual ao Vel Sites */
        }
        
        .form-container {
            display: flex;
            flex-direction: column;
            position: relative;
            min-height: 800px; /* Altura mínima para acomodar o conteúdo e a navegação fixa */
        }

        #wizard-steps-container {
            position: relative;
            flex-grow: 1;
            transition: height 0.4s ease-in-out;
        }

        #resume-form fieldset {
            transition: opacity 0.4s ease-in-out, transform 0.4s ease-in-out;
            position: absolute;
            width: 100%;
            background-color: white; /* Garante que os steps não sejam transparentes durante a transição */
        }
        
        #resume-form fieldset:not(.step-active) {
            opacity: 0;
            transform: translateX(20px);
            pointer-events: none;
        }
        
        #resume-form fieldset.step-active {
            opacity: 1;
            transform: translateX(0);
        }
        
        #wizard-header {
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 1rem;
        }

        #wizard-step-title {
            font-size: 1.25rem; /* text-xl */
            font-weight: 700; /* font-bold */
        }
        
        #wizard-progress-bar {
            height: 0.5rem; /* h-2 */
        }
        
        #wizard-nav {
            position: sticky;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            padding: 1rem 1.5rem;
            border-top: 1px solid #e5e7eb;
            margin: 0 -1.5rem -1.5rem; /* Ajuste para preencher a largura do padding do container */
            border-bottom-left-radius: 0.5rem;
            border-bottom-right-radius: 0.5rem;
        }

        .resume-preview {
            width: 794px;
            min-height: 1123px;
            background-color: white;
            transition: all 0.3s ease-in-out;
            transform-origin: top left;
            position: relative; /* ADICIONADO: Necessário para o posicionamento do QR Code */
        }
        
        @media print {
            .form-container, .export-button-container { display: none; }
            .resume-preview { box-shadow: none; margin: 0; padding: 0; width: 100%; min-height: auto; }
            body { margin: 0; padding: 0; }
        }

        /* --- ESTILOS GERAIS PARA TÍTULOS DE SECÇÃO --- */
        .section-title {
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
            border-bottom-width: 1px;
        }
        
        /* --- TEMPLATE CLÁSSICO (Padrão) --- */
        .template-classic { padding: 50px 75px; }
        .template-classic header { text-align: center; border-bottom: 1px solid #e5e7eb; padding-bottom: 1.5rem; }
        .template-classic #resume-name { color: var(--theme-color); }
        .template-classic .section-title { font-size: 1.25rem; color: var(--theme-color); border-color: #d1d5db; }
        
        /* --- TEMPLATE MODERNO --- */
        .template-modern { padding: 0; }
        /* ALTERAÇÃO: Ajustado o padding para a nova estrutura */
        .template-modern header { 
            background-color: var(--theme-color); 
            color: white; 
            text-align: left; 
            padding: 40px 50px 30px; /* Reduzido o padding inferior */
            border-bottom: none; 
            position: relative; /* Necessário para a foto */
        }
        /* ALTERAÇÃO: Reduzido o tamanho da fonte do nome */
        .template-modern #resume-name { color: white; font-size: 2.25rem; /* Era 2.5rem */ }
        .template-modern #resume-job-title { color: #e0e7ff; }
        /* ALTERAÇÃO: Movido o #contact-info para uma grelha e ajustado o estilo */
        .template-modern #contact-info {
            display: grid;
            grid-template-columns: repeat(2, 1fr); /* 2 colunas */
            gap: 0.5rem 1.5rem; /* Espaçamento entre linhas e colunas */
            margin-top: 1.5rem; /* Espaço abaixo do nome/cargo */
            padding-top: 1.5rem; /* Espaço acima */
            border-top: 1px solid #3b82f6; /* Linha divisória (blue-500) */
        }
        .template-modern #contact-info a, 
        .template-modern #contact-info div { 
            color: #c7d2fe; 
            display: flex; 
            align-items: center; 
            gap: 0.5rem; /* Espaço entre ícone e texto */
        }
        .template-modern #contact-info svg {
            width: 1rem; /* 16px */
            height: 1rem; /* 16px */
            flex-shrink: 0; /* Impede que o ícone encolha */
        }
        /* Fim da Alteração */

        .template-modern main { padding: 40px 50px; }
        .template-modern .section-title { color: var(--theme-color); border-color: #d1d5db; }

        /* --- TEMPLATE MINIMALISTA --- */
        .template-minimalist { padding: 50px 75px; font-family: 'Lato', sans-serif; }
        .template-minimalist header { text-align: left; border-bottom: 2px solid #111827; padding-bottom: 1rem; }
        .template-minimalist #resume-name { color: #111827; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; font-size: 2rem; }
        .template-minimalist #resume-job-title { font-weight: 400; color: #6B7280; margin-top: 0.25rem; }
        .template-minimalist #contact-info { justify-content: flex-start; margin-top: 0.75rem; }
        .template-minimalist main { margin-top: 2rem; }
        .template-minimalist .section-title { font-size: 1rem; font-weight: 700; color: #111827; border: none; margin-bottom: 0.75rem; }
        .template-minimalist section { padding-bottom: 1rem; border-bottom: 1px solid #e5e7eb; }
        .template-minimalist section:last-child { border-bottom: none; }

        .gradient-text {
            background: var(--gradiente-texto);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        #view-mode-wrapper {
            padding: 2rem;
            background-color: #f3f4f6; /* bg-gray-100 */
            min-height: 100vh;
        }

        .btn-primary {
            background: linear-gradient(135deg, #002e9e, #0078e8);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 120, 232, 0.3);
        }

        .footer-logo {
            width: 130px; 
            height: auto;
        }
        .footer-social-icon {
            transition: all 0.3s ease;
        }
        .footer-social-icon:hover {
            background-color: rgba(255, 255, 255, 0.4) !important;
            transform: scale(1.1);
        }
        
        /* --- Animação do Scroller de Avaliações (ATUALIZADO) --- */
        .scroller {
            max-width: 100%;
        }

        .scroller__inner {
            padding-block: 1rem;
            display: flex;
            flex-wrap: nowrap;
            gap: 1rem;
        }
        
        .scroller[data-animated="true"] {
            overflow: hidden;
            -webkit-mask: linear-gradient(90deg, transparent, white 20%, white 80%, transparent);
            mask: linear-gradient(90deg, transparent, white 20%, white 80%, transparent);
        }
        
        .scroller[data-animated="true"] .scroller__inner {
            width: max-content;
            animation: scroll 80s linear infinite;
        }

        .scroller[data-direction="right"] .scroller__inner {
            animation-direction: reverse;
        }

        @keyframes scroll {
            to {
                transform: translate(calc(-50% - .5rem));
            }
        }

        /* --- ANIMAÇÕES DO MODO DEMO (ADICIONADO) --- */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeOut {
            from {
                opacity: 1;
                transform: translateY(0);
            }
            to {
                opacity: 0;
                transform: translateY(5px);
            }
        }

        /* Estado Inicial: Oculta elementos e prepara para animar */
        .is-demo-mode .demo-element {
            opacity: 0;
            animation: fadeInUp 0.5s ease-out forwards;
        }

        /* Estado de Saída: Aplica animação de fade-out */
        .is-fading-out .demo-element {
            animation: fadeOut 0.3s ease-in forwards;
        }

        /* Esconde elementos de contacto reais (que estão vazios) durante o modo demo */
        .is-demo-mode #contact-info a[style*="display: none"],
        .is-demo-mode #contact-info div[style*="display: none"] {
            display: none !important;
        }

        /* ADICIONADO: Estilo para os botões de atalho da formação */
        .education-shortcut-btn {
            background-color: #eef2ff; /* indigo-100 */
            color: #4338ca; /* indigo-700 */
            font-size: 0.875rem; /* text-sm */
            font-weight: 500; /* medium */
            padding: 0.5rem 0.75rem; /* py-2 px-3 */
            border-radius: 0.5rem; /* rounded-lg */
            transition: all 0.2s ease;
        }
        .education-shortcut-btn:hover {
            background-color: #e0e7ff; /* indigo-200 */
            transform: translateY(-1px);
        }

        /* ADICIONADO: Estilo para o botão de atalho selecionado */
        .education-shortcut-btn.selected {
            background-color: #4338ca; /* indigo-700 */
            color: white;
            transform: translateY(0);
        }
        .education-shortcut-btn.selected:hover {
            background-color: #3730a3; /* indigo-800 */
        }

        /* ADICIONADO: Estilo para o QR Code do WhatsApp */
        #whatsapp-qr-code-container {
            position: absolute;
            bottom: 1.5rem; /* 24px */
            right: 1.5rem; /* 24px */
            display: none; /* Começa escondido */
            flex-direction: column;
            align-items: center;
            background-color: white;
            padding: 0.5rem; /* 8px */
            border-radius: 0.5rem; /* rounded-lg */
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            z-index: 10;
        }

        /* ADICIONADO: Estilos para o upload de foto de perfil */
        #profile-pic-upload {
            display: none; /* Esconde o input file padrão */
        }
        
        #profile-pic-label {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem; /* 8px */
            background-color: #eef2ff; /* indigo-100 */
            color: #4338ca; /* indigo-700 */
            font-weight: 500; /* medium */
            padding: 0.5rem 1rem; /* py-2 px-4 */
            border-radius: 0.5rem; /* rounded-lg */
            cursor: pointer;
            transition: all 0.2s ease;
            width: 100%;
        }
        #profile-pic-label:hover {
            background-color: #e0e7ff; /* indigo-200 */
        }

        /* ADICIONADO: Estilos base do container da foto no preview */
        #profile-pic-container {
            display: none; /* Começa escondido */
            position: absolute;
            z-index: 5;
            overflow: hidden;
            background-color: #e5e7eb; /* bg-gray-200 */
        }
        #profile-pic-img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        /* ADICIONADO: Estilos específicos por template */
        
        /* Moderno: Círculo no header */
        .template-modern #profile-pic-container {
            width: 100px;
            height: 100px;
            border-radius: 9999px; /* rounded-full */
            top: 2.5rem; /* 40px */
            right: 3.125rem; /* 50px */
            border: 3px solid white;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            /* ALTERAÇÃO: Garantir que a foto está acima do cabeçalho */
            z-index: 6; 
        }

        /* Clássico: Quadrado no canto */
        .template-classic #profile-pic-container {
            width: 110px;
            height: 130px;
            border-radius: 0.5rem; /* rounded-lg */
            top: 3.125rem; /* 50px */
            right: 4.6875rem; /* 75px */
            border: 1px solid #e5e7eb; /* border-gray-200 */
        }

        /* Minimalista: Círculo ao lado do nome */
        .template-minimalist #profile-pic-container {
            width: 80px;
            height: 80px;
            border-radius: 9999px; /* rounded-full */
            top: 3.125rem; /* 50px */
            right: 4.6875rem; /* 75px */
        }
        /* Ajuste no header minimalista para dar espaço à foto */
        .template-minimalist header {
            position: relative;
            padding-right: 110px; /* Espaço para a foto */
        }


        /* ADICIONADO: Estilo para as sugestões de habilidades */
        .skill-suggestion-btn {
            background-color: #eef2ff; /* indigo-100 */
            color: #4338ca; /* indigo-700 */
            font-size: 0.75rem; /* text-xs */
            font-weight: 500; /* medium */
            padding: 0.25rem 0.75rem; /* py-1 px-3 */
            border-radius: 9999px; /* rounded-full */
            transition: all 0.2s ease;
        }
        .skill-suggestion-btn:hover:not(:disabled) {
            background-color: #e0e7ff; /* indigo-200 */
            transform: translateY(-1px);
        }
        .skill-suggestion-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        /* ADICIONADO: Estilo para os botões da grelha de seleção (Estado Civil, CNH) */
        .selection-grid-btn {
            background-color: #eef2ff; /* indigo-100 */
            color: #4338ca; /* indigo-700 */
            font-size: 0.875rem; /* text-sm */
            font-weight: 500; /* medium */
            padding: 0.5rem; /* py-2 */
            border-radius: 0.5rem; /* rounded-lg */
            transition: all 0.2s ease;
            text-align: center;
        }
        .selection-grid-btn:hover:not(.selected) {
            background-color: #e0e7ff; /* indigo-200 */
        }
        .selection-grid-btn.selected {
            background-color: #4338ca; /* indigo-700 */
            color: white;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        /* ADICIONADO: Estilos para o Modal de Seleção */
        #selection-modal-overlay {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 90;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        #selection-modal-content {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) scale(0.95);
            background-color: white;
            border-radius: 0.5rem; /* rounded-lg */
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            z-index: 100;
            width: 90%;
            max-width: 320px; /* sm:max-w-sm */
            opacity: 0;
            transition: all 0.3s ease;
        }
        #selection-modal-overlay:not(.hidden) { opacity: 1; }
        #selection-modal-content:not(.hidden) { opacity: 1; transform: translate(-50%, -50%) scale(1); }

        /* Estilo para os botões de opção no modal */
        .modal-option-btn {
            display: block;
            width: 100%;
            padding: 0.75rem 1.25rem; /* py-3 px-5 */
            text-align: left;
            font-size: 0.875rem; /* text-sm */
            color: #374151; /* text-gray-700 */
            transition: background-color 0.2s ease;
        }
        .modal-option-btn:hover {
            background-color: #f3f4f6; /* bg-gray-100 */
        }
        /* Fim dos estilos do Modal */

    </style>
</head>

<body class="bg-gray-100 text-gray-800">

    <div id="main-content-wrapper">
        <!-- CORREÇÃO: Aumentado o tamanho do logo para melhor visibilidade e removido um '}' extra que quebrava o HTML. -->
        <header class="fixed top-6 left-6 right-6 bg-blue-800/80 backdrop-blur-lg z-50 border border-white/10 rounded-full shadow-lg">
            <div class="px-6 py-3 flex justify-between items-center">
                <a href="https://velsites.com.br/" class="flex items-center">
                    <!-- ALTERAÇÃO: A altura foi ajustada de h-3 para h-5 (aprox. 60% do original h-8) -->
                    <img src="https://i.postimg.cc/yNWrvPQJ/Subcabe-alho-76.png" alt="Vel Sites Logo" class="h-5 mr-3">
                </a>
                <nav>
                    <a href="https://velsites.com.br/" class="text-white hover:text-blue-200 font-medium transition">Início</a>
                </nav>
            </div>
        </header>

        <main class="container mx-auto p-4 lg:p-8" style="padding-top: 9rem;">
            
            <!-- SEÇÃO 1: INTRODUÇÃO -->
            <section id="intro" class="text-center mb-16">
                <h1 class="text-4xl lg:text-5xl font-bold gradient-text">Destaque-se na multidão.</h1>
                <p class="text-lg text-gray-600 mt-4 max-w-3xl mx-auto">Cansado de templates genéricos? A nossa ferramenta gratuita cria currículos profissionais e modernos em minutos, com a ajuda de Inteligência Artificial, para que a sua primeira impressão seja inesquecível.</p>
                <a href="#gerador" class="mt-8 inline-block btn-primary text-white font-bold py-3 px-8 rounded-full shadow-lg transition-all duration-300">Criar meu Currículo Grátis</a>
            </section>

            <!-- SEÇÃO 2: GERADOR DE CURRÍCULO -->
            <section id="gerador" class="mb-16 scroll-mt-24">
                 <div class="my-8 flex justify-center">
                    <img src="https://files.catbox.moe/aid7gz.png" alt="Visualização dos modelos de currículo" class="max-w-full md:max-w-sm rounded-lg">
                </div>

                <div class="flex flex-col lg:flex-row gap-8">
                    <!-- Coluna do Formulário --><div class="w-full lg:w-1/3 bg-white p-6 rounded-lg shadow-md form-container">
                        <div id="wizard-header" class="mb-4 text-center">
                            <p id="wizard-step-info" class="text-sm font-medium text-gray-500 mb-1"></p>
                            <h3 id="wizard-step-title" class="gradient-text"></h3>
                            <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                                <div id="wizard-progress-bar" class="btn-primary h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                            </div>
                        </div>

                        <form id="resume-form" class="space-y-6 flex-grow">
                            <div id="wizard-steps-container">
                            <!-- Estilo do Currículo --><fieldset class="border-0 p-4">
                                <legend class="hidden text-lg font-semibold px-2 mb-4">Estilo e Design</legend>
                                <div>
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Selecione o Template</label>
                                    <div id="template-selector" class="flex flex-col gap-3">
                                        <!-- ALTERAÇÃO: Template "Moderno" movido para o topo e definido como padrão -->
                                        <div class="template-option cursor-pointer border-2 border-blue-600 rounded-lg p-2 flex items-center gap-4" data-template="template-modern" title="Modelo Moderno">
                                            <svg viewBox="0 0 100 140" class="w-16 h-auto rounded-md pointer-events-none bg-gray-100 p-1 border">
                                                <rect x="10" y="10" width="25" height="120" rx="3" fill="#cbd5e1"></rect>
                                                <rect x="45" y="10" width="45" height="15" rx="3" fill="#cbd5e1"></rect>
                                                <rect x="45" y="35" width="45" height="5" rx="2" fill="#e2e8f0"></rect>
                                                <rect x="45" y="45" width="35" height="5" rx="2" fill="#e2e8f0"></rect>
                                                <rect x="45" y="65" width="45" height="8" rx="3" fill="#cbd5e1"></rect>
                                                <rect x="45" y="80" width="40" height="5" rx="2" fill="#e2e8f0"></rect>
                                            </svg>
                                            <span class="font-semibold text-sm">Moderno</span>
                                        </div>
                                        <div class="template-option cursor-pointer border-2 border-gray-300 rounded-lg p-2 flex items-center gap-4" data-template="template-classic" title="Modelo Clássico">
                                            <svg viewBox="0 0 100 140" class="w-16 h-auto rounded-md pointer-events-none bg-gray-100 p-1 border">
                                                <rect x="10" y="10" width="80" height="15" rx="3" fill="#cbd5e1"></rect>
                                                <rect x="10" y="35" width="80" height="5" rx="2" fill="#e2e8f0"></rect>
                                                <rect x="10" y="45" width="60" height="5" rx="2" fill="#e2e8f0"></rect>
                                                <rect x="10" y="65" width="80" height="8" rx="3" fill="#cbd5e1"></rect>
                                                <rect x="10" y="80" width="70" height="5" rx="2" fill="#e2e8f0"></rect>
                                                <rect x="10" y="90" width="80" height="5" rx="2" fill="#e2e8f0"></rect>
                                                <rect x="10" y="100" width="50" height="5" rx="2" fill="#e2e8f0"></rect>
                                            </svg>
                                            <span class="font-semibold text-sm">Clássico</span>
                                        </div>
                                        <div class="template-option cursor-pointer border-2 border-gray-300 rounded-lg p-2 flex items-center gap-4" data-template="template-minimalist" title="Modelo Minimalista">
                                            <svg viewBox="0 0 100 140" class="w-16 h-auto rounded-md pointer-events-none bg-gray-100 p-1 border">
                                                <rect x="10" y="10" width="80" height="10" rx="3" fill="#cbd5e1"></rect>
                                                <rect x="10" y="30" width="40" height="5" rx="2" fill="#e2e8f0"></rect>
                                                <line x1="10" y1="50" x2="90" y2="50" stroke="#e2e8f0" stroke-width="2"></line>
                                                <rect x="10" y="65" width="80" height="8" rx="3" fill="#cbd5e1"></rect>
                                                <rect x="10" y="80" width="70" height="5" rx="2" fill="#e2e8f0"></rect>
                                            </svg>
                                            <span class="font-semibold text-sm">Minimalista</span>
                                        </div>
                                    </div>
                                </div>
                                <div class="mt-4">
                                    <label class="block text-sm font-medium text-gray-700 mb-2">Escolha uma Cor de Destaque</label>
                                    <div id="color-palette" class="flex gap-3">
                                        <div class="color-option w-8 h-8 rounded-full cursor-pointer border-4 border-blue-600" style="background-color: #002e9e;" data-color="#002e9e"></div>
                                        <div class="color-option w-8 h-8 rounded-full cursor-pointer border-4 border-white" style="background-color: #0078e8;" data-color="#0078e8"></div>
                                        <div class="color-option w-8 h-8 rounded-full cursor-pointer border-4 border-white" style="background-color: #374151;" data-color="#374151"></div>
                                        <div class="color-option w-8 h-8 rounded-full cursor-pointer border-4 border-white" style="background-color: #065f46;" data-color="#065f46"></div>
                                    </div>
                                </div>
                            </fieldset>


                            <!-- Informações Pessoais --><fieldset class="border-0 p-4">
                                <legend class="hidden text-lg font-semibold px-2 mb-4">Informações Pessoais</legend>
                                <div class="space-y-4">
                                    <input type="text" id="name" placeholder="Nome Completo" class="w-full p-2 border rounded-md" data-target="resume-name">
                                    <input type="text" id="job-title" placeholder="Cargo Desejado" class="w-full p-2 border rounded-md" data-target="resume-job-title">
                                    <input type="email" id="email" placeholder="E-mail" class="w-full p-2 border rounded-md" data-target="resume-email">
                                    <!-- ALTERAÇÃO: Placeholder atualizado -->
                                    <input type="tel" id="phone" placeholder="Telefone" class="w-full p-2 border rounded-md" data-target="resume-phone" maxlength="16">
                                    
                                    <!-- ALTERAÇÃO: Checkbox substituído por 'toggle switch' e texto atualizado -->
                                    <div class="flex items-center justify-between mt-2">
                                        <!-- ADICIONADO: 'pl-1' para mover o texto ligeiramente para a direita -->
                                        <label for="show-whatsapp-qr" class="text-sm font-medium text-gray-700 pl-1">Exibir QR Code</label>
                                        <label class="relative inline-flex items-center cursor-pointer">
                                            <input type="checkbox" id="show-whatsapp-qr" class="sr-only peer" checked>
                                            <div class="w-10 h-5 bg-gray-300 rounded-full peer-checked:bg-indigo-600 transition-colors duration-200"></div>
                                            <div class="absolute left-0.5 top-0.5 w-4 h-4 bg-white rounded-full shadow transition-transform duration-200 peer-checked:translate-x-5"></div>
                                        </label>
                                    </div>
                                    <!-- Fim da Alteração -->

                                    <input type="text" id="address" placeholder="Endereço (Ex: Cidade, Estado)" class="w-full p-2 border rounded-md" data-target="resume-address">
                                    <!-- ALTERAÇÃO: Campo de LinkedIn substituído por Idade -->
                                    <input type="tel" id="age" placeholder="Idade" class="w-full p-2 border rounded-md" data-target="resume-age" maxlength="2">
                                
                                    <!-- ALTERAÇÃO: Campo de Estado Civil (agora abre modal) -->
                                    <div class="relative">
                                        <input type="text" id="marital-status" placeholder="Estado Civil" class="w-full p-2 border rounded-md cursor-pointer" data-target="resume-marital-status" readonly>
                                        <svg class="w-4 h-4 text-gray-400 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                                    </div>
                                    <!-- Fim da Alteração -->

                                    <!-- ALTERAÇÃO: Campo CNH (agora abre modal) -->
                                    <div class="relative">
                                        <!-- ALTERAÇÃO: Removida a classe 'mt-4' para corrigir o espaçamento e o alinhamento da seta -->
                                        <input type="text" id="cnh" placeholder="CNH" class="w-full p-2 border rounded-md cursor-pointer" data-target="resume-cnh" readonly>
                                        <svg class="w-4 h-4 text-gray-400 absolute right-3 top-1/2 -translate-y-1/2 pointer-events-none" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                                    </div>
                                    <!-- Fim da Alteração -->

                                    <!-- ADICIONADO: Botão de Upload de Foto -->
                                    <div class="mt-4">
                                        <label for="profile-pic-upload" id="profile-pic-label">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-upload"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                                            Carregar Foto
                                        </label>
                                        <input type="file" id="profile-pic-upload" accept="image/png, image/jpeg">
                                        <p class="text-xs text-gray-500 mt-1 text-center">PNG ou JPG (Recomendado: 1:1)</p>
                                    </div>
                                    <!-- Fim da Alteração -->
                                </div>
                            </fieldset>

                            <!-- Resumo Profissional --><fieldset class="border-0 p-4">
                                <legend class="hidden text-lg font-semibold px-2 mb-4">Resumo Profissional</legend>
                                <div class="relative">
                                    <textarea id="summary" placeholder="Fale sobre sua carreira, objetivos e qualificações..." class="w-full p-2 border rounded-md h-32" data-target="resume-summary"></textarea>
                                    <!-- Botão de IA removido daqui -->
                                </div>
                                
                                <!-- ALTERAÇÃO: Novo botão de IA e texto de instrução -->
                                <button type
="button" id="enhance-summary" title="Melhorar com IA" class="mt-4 w-full flex items-center justify-center gap-2 bg-indigo-600 text-white font-semibold py-2 px-4 rounded-full hover:bg-indigo-700 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sparkles"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M19 17v4"/><path d="M3 5h4"/><path d="M17 19h4"/></svg>
                                    Escrever com IA
                                </button>
                                <p class="text-xs text-gray-500 mt-2 text-center">Escreva um pouco sobre você no campo acima e clique no botão para aprimorar o texto.</p>
                                <!-- Fim da Alteração -->

                            </fieldset>

                            <!-- Experiência Profissional --><fieldset class="border-0 p-4">
                                <legend class="hidden text-lg font-semibold px-2 mb-4">Experiência Profissional</legend>
                                <div id="experience-list" class="space-y-4"></div>
                                <button type="button" id="add-experience" class="mt-6 w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold py-2 px-4 rounded-full transition-colors flex items-center justify-center gap-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus-circle"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
                                    Adicionar mais
                                </button>
                            </fieldset>

                            <!-- Formação Acadêmica --><fieldset class="border-0 p-4">
                                <legend class="hidden text-lg font-semibold px-2 mb-4">Formação Acadêmica</legend>
                                
                                <!-- ADICIONADO: Botões de atalho -->
                                <label class="block text-sm font-medium text-gray-700 mb-2">Preenchimento Rápido</label>
                                <div class="flex flex-wrap gap-2 mb-4">
                                    <button type="button" class="education-shortcut-btn" data-degree="Ensino Médio Completo">Ensino Médio Completo</button>
                                    <button type="button" class="education-shortcut-btn" data-degree="Ensino Médio Incompleto">Ensino Médio Incompleto</button>
                                    <button type="button" class="education-shortcut-btn" data-degree="Ensino Fundamental">Ensino Fundamental</button>
                                </div>
                                <!-- Fim do Bloco Adicionado -->

                                <div id="education-list" class="space-y-4"></div>
                                <button type="button" id="add-education" class="mt-6 w-full bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold py-2 px-4 rounded-full transition-colors flex items-center justify-center gap-2">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus-circle"><circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="16"/><line x1="8" y1="12" x2="16" y2="12"/></svg>
                                    Adicionar mais
                                </button>
                            </fieldset>

                            <!-- Habilidades --><fieldset class="border-0 p-4">
                                <legend class="hidden text-lg font-semibold px-2 mb-4">Habilidades</legend>
                                <input type="text" id="skills" placeholder="Ex: HTML, CSS, Liderança" class="w-full p-2 border rounded-md" data-target="resume-skills">
                                <p class="text-xs text-gray-500 mt-1">Separe as habilidades por vírgula.</p>
                                
                                <!-- ADICIONADO: Sugestões de Habilidades -->
                                <label class="block text-sm font-medium text-gray-700 mt-4 mb-2">Sugestões (clique para adicionar):</label>
                                <div id="skill-suggestion-container" class="flex flex-wrap gap-2">
                                    <button type="button" class="skill-suggestion-btn">Pacote Office</button>
                                    <button type="button" class="skill-suggestion-btn">Excel Avançado</button>
                                    <button type="button" class="skill-suggestion-btn">Comunicação Efetiva</button>
                                    <button type="button" class="skill-suggestion-btn">Trabalho em Equipa</button>
                                    <button type="button" class="skill-suggestion-btn">Liderança</button>
                                    <button type="button" class="skill-suggestion-btn">Proatividade</button>
                                    <button type="button" class="skill-suggestion-btn">Organização</button>
                                    <button type="button" class="skill-suggestion-btn">Atendimento ao Cliente</button>
                                    <button type="button" class="skill-suggestion-btn">Gestão de Tempo</button>
                                </div>
                                <!-- Fim do Bloco Adicionado -->

                            </fieldset>
                            </div>
                        </form>

                        <div id="completion-view" class="hidden text-center p-8 flex-grow flex flex-col justify-center items-center">
                            <svg class="w-16 h-16 text-green-500" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/></svg>
                            <h3 class="text-2xl font-bold mt-4">Seu currículo está pronto!</h3>
                            <p class="text-gray-600 mt-2">Pode agora baixar o seu PDF ou voltar para fazer mais edições.</p>
                        </div>

                        <div id="wizard-nav" class="mt-auto flex justify-between gap-4">
                            <button type="button" id="prev-step-button" class="bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-full hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-300 ease-in-out">Anterior</button>
                            <button type="button" id="next-step-button" class="btn-primary text-white font-semibold py-2 px-4 rounded-full transition-all duration-300 ease-in-out flex-grow">Próximo</button>
                        </div>
                    </div>

                    <!-- Coluna da Visualização --><div class="w-full lg:w-2/3">
                        <div id="preview-wrapper" class="w-full overflow-hidden rounded-lg shadow-md">
                            <!-- ALTERAÇÃO: A classe padrão do preview agora é "template-modern" -->
                            <div id="resume-preview" class="resume-preview bg-white text-gray-900 template-modern">
                                
                                <!-- ADICIONADO: Container da Foto de Perfil -->
                                <div id="profile-pic-container">
                                    <img id="profile-pic-img" src="" alt="Foto de Perfil">
                                </div>
                                <!-- Fim da Alteração -->

                                <!-- Cabeçalho --><header class="pb-6">
                                    <!-- ALTERAÇÃO: Reestruturação do cabeçalho do template Moderno -->
                                    <div class="flex justify-between items-start">
                                        <div class="pr-4" style="max-width: calc(100% - 120px);"> <!-- Espaço para a foto -->
                                            <!-- DADO DE EXEMPLO ADICIONADO -->
                                            <h1 id="resume-name" class="text-4xl font-bold demo-element" style="animation-delay: 100ms;">Ana Maria Silva</h1>
                                            <h2 id="resume-job-title" class="text-xl font-medium text-gray-600 mt-1 demo-element" style="animation-delay: 200ms;">Desenvolvedora Front-End</h2>
                                        </div>
                                        <!-- A foto de perfil (#profile-pic-container) é posicionada aqui via CSS -->
                                    </div>
                                    
                                    <!-- ALTERAÇÃO: Bloco de Contacto movido para baixo e redesenhado com ícones -->
                                    <div id="contact-info" class="mt-4 text-sm">
                                        <!-- DADO DE EXEMPLO ADICIONADO -->
                                        <a href="#" id="resume-email-container" class="text-gray-700 hover:text-blue-600 transition-colors demo-element" style="animation-delay: 300ms;">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"/><polyline points="22,6 12,13 2,6"/></svg>
                                            <span id="resume-email">ana.silva@email.com</span>
                                        </a>
                                        <a href="#" id="resume-phone-container" class="text-gray-700 hover:text-blue-600 transition-colors demo-element" style="animation-delay: 400ms;">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"/></svg>
                                            <span id="resume-phone">(11) 98765-4321</span>
                                        </a>
                                        <div id="resume-address-container" class="text-gray-700 demo-element" style="animation-delay: 500ms;">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/></svg>
                                            <span id="resume-address">São Paulo, SP</span>
                                        </div>
                                        <div id="resume-age-container" class="text-gray-700" style="display: none;">
                                            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22c5.523 0 10-4.477 10-10S17.523 2 12 2 2 6.477 2 12s4.477 10 10 10z"/><path d="M12 6v6l4 2"/></svg>
                                            <span id="resume-age"></span>
                                        </div>
                                        
                                        <!-- ADICIONADO: Container do Estado Civil -->
                                        <div id="resume-marital-status-container" class="text-gray-700" style="display: none;">
                                           <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                                           <span id="resume-marital-status"></span>
                                        </div>
                                        <!-- Fim da Alteração -->

                                        <!-- ADICIONADO: Container da CNH -->
                                        <div id="resume-cnh-container" class="text-gray-700" style="display: none;">
                                           <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9L1 16v5c0 .6.4 1 1 1h3c.6 0 1-.4 1-1v-1h12v1c0 .6.4 1 1 1zM2 16l1.5-4.5h11L16 16H2zm13 1v-1H5v1h10zm-1-4h.5c.3 0 .5-.2.5-.5s-.2-.5-.5-.5H14v1z"/></svg>
                                           <span id="resume-cnh"></span>
                                        </div>
                                        <!-- Fim da Alteração -->
                                    </div>
                                    <!-- Fim da Alteração -->
                                </header>

                            <main class="mt-8 space-y-8">
                                <section id="summary-section">
                                    <h3 class="section-title demo-element" style="animation-delay: 600ms;">Resumo Profissional</h3>
                                    <!-- DADO DE EXEMPLO ADICIONADO -->
                                    <p id="resume-summary" class="text-gray-700 leading-relaxed demo-element" style="animation-delay: 650ms;">Desenvolvedora front-end proativa com 3+ anos de experiência na criação de interfaces de usuário responsivas e performáticas com React e Vue.js. Apaixonada por design limpo e em busca de novos desafios para aplicar minhas habilidades em UI/UX.</p>
                                </section>
                                <section id="experience-section">
                                    <h3 class="section-title demo-element" style="animation-delay: 750ms;">Experiência Profissional</h3>
                                    <!-- DADO DE EXEMPLO ADICIONADO -->
                                    <div id="resume-experience-list" class="space-y-6">
                                        <div class="demo-element" style="animation-delay: 800ms;">
                                            <div class="flex justify-between items-baseline flex-wrap">
                                                <div class="pr-4">
                                                    <h4 class="text-lg font-semibold">Desenvolvedora Front-End Pleno</h4>
                                                    <p class="text-md text-gray-700">Tech Solutions &bull; São Paulo, SP</p>
                                                </div>
                                                <p class="text-sm text-gray-500 text-right whitespace-nowrap">Jan 2022 - Atual</p>
                                            </div>
                                            <p class="mt-2 text-gray-600 leading-relaxed">Liderança no desenvolvimento do novo portal do cliente usando React, resultando em um aumento de 25% na retenção de usuários. Otimização de performance (Core Web Vitals) e mentoria de desenvolvedores júnior.</p>
                                        </div>
                                        <div class="demo-element" style="animation-delay: 900ms;">
                                            <div class="flex justify-between items-baseline flex-wrap">
                                                <div class="pr-4">
                                                    <h4 class="text-lg font-semibold">Desenvolvedora Front-End Júnior</h4>
                                                    <p class="text-md text-gray-700">Web Agil &bull; Remoto</p>
                                                </div>
                                                <p class="text-sm text-gray-500 text-right whitespace-nowrap">Mar 2020 - Dez 2021</p>
                                            </div>
                                            <p class="mt-2 text-gray-600 leading-relaxed">Desenvolvimento e manutenção de landing pages e e-commerces em Vue.js, garantindo total responsividade e acessibilidade (WCAG).</p>
                                        </div>
                                    </div>
                                </section>
                                <section id="education-section">
                                    <h3 class="section-title demo-element" style="animation-delay: 1000ms;">Formação Acadêmica</h3>
                                    <!-- DADO DE EXEMPLO ADICIONADO -->
                                    <div id="resume-education-list" class="space-y-4">
                                        <div class="demo-element" style="animation-delay: 1050ms;">
                                            <div class="flex justify-between items-baseline flex-wrap">
                                                <div class="pr-4">
                                                    <h4 class="text-lg font-semibold">Análise e Desenvolvimento de Sistemas</h4>
                                                    <p class="text-md text-gray-700">Universidade Estácio de Sá</p>
                                                </div>
                                                <p class="text-sm text-gray-500 text-right whitespace-nowrap">2018 - 2020</p>
                                            </div>
                                        </div>
                                    </div>
                                </section>
                                <section id="skills-section">
                                    <h3 class="section-title demo-element" style="animation-delay: 1150ms;">Habilidades</h3>
                                    <!-- DADO DE EXEMPLO ADICIONADO -->
                                    <div id="resume-skills" class="demo-element" style="animation-delay: 1200ms;">
                                        <span class="inline-block h-7 leading-7 bg-gray-200 rounded-full px-4 text-sm font-semibold text-gray-700 mr-2 mb-2 align-top">React</span>
                                        <span class="inline-block h-7 leading-7 bg-gray-200 rounded-full px-4 text-sm font-semibold text-gray-700 mr-2 mb-2 align-top">JavaScript (ES6+)</span>
                                        <span class="inline-block h-7 leading-7 bg-gray-200 rounded-full px-4 text-sm font-semibold text-gray-700 mr-2 mb-2 align-top">TypeScript</span>
                                        <span class="inline-block h-7 leading-7 bg-gray-200 rounded-full px-4 text-sm font-semibold text-gray-700 mr-2 mb-2 align-top">Vue.js</span>
                                        <span class="inline-block h-7 leading-7 bg-gray-200 rounded-full px-4 text-sm font-semibold text-gray-700 mr-2 mb-2 align-top">Tailwind CSS</span>
                                        <span class="inline-block h-7 leading-7 bg-gray-200 rounded-full px-4 text-sm font-semibold text-gray-700 mr-2 mb-2 align-top">Metodologias Ágeis</span>
                                    </div>
                                </section>
                            </main>

                            <!-- ADICIONADO: Container do QR Code do WhatsApp -->
                            <div id="whatsapp-qr-code-container" class="items-center">
                                <!-- ALTERAÇÃO: SVG e texto substituídos por uma imagem SVG externa -->
                                <img src="https://files.catbox.moe/cvyrae.svg" alt="Ícone do WhatsApp" class="h-8 mb-2">
                                <!-- Fim da Alteração -->
                                <img id="qr-code-img" alt="QR Code do WhatsApp" class="w-20 h-20"> <!-- w-20 h-20 (80px) -->
                            </div>

                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SEÇÃO 3: COMO FUNCIONA -->
            <section id="como-funciona" class="text-center my-24">
                <h2 class="text-3xl font-bold text-gray-800">Simples, Rápido e Eficaz</h2>
                <p class="text-lg text-gray-600 mt-2 max-w-2xl mx-auto">Criar um currículo de destaque nunca foi tão fácil. Siga apenas 3 passos:</p>
                <div class="mt-12 grid md:grid-cols-3 gap-8">
                    <!-- Passo 1 -->
                    <div class="flex flex-col items-center">
                        <div class="flex items-center justify-center w-16 h-16 rounded-full btn-primary text-white text-2xl font-bold mb-4">1</div>
                        <h3 class="text-xl font-semibold mb-2">Preencha</h3>
                        <p class="text-gray-600">Insira as suas informações nos campos guiados. A nossa IA pode ajudar a refinar os textos.</p>
                    </div>
                    <!-- Passo 2 -->
                    <div class="flex flex-col items-center">
                        <div class="flex items-center justify-center w-16 h-16 rounded-full btn-primary text-white text-2xl font-bold mb-4">2</div>
                        <h3 class="text-xl font-semibold mb-2">Personalize</h3>
                        <p class="text-gray-600">Escolha entre templates modernos e ajuste a cor para combinar com o seu estilo.</p>
                    </div>
                    <!-- Passo 3 -->
                    <div class="flex flex-col items-center">
                         <div class="flex items-center justify-center w-16 h-16 rounded-full btn-primary text-white text-2xl font-bold mb-4">3</div>
                        <h3 class="text-xl font-semibold mb-2">Exporte</h3>
                        <p class="text-gray-600">Baixe o seu novo currículo em formato PDF, pronto para ser enviado.</p>
                    </div>
                </div>
            </section>
            
            <!-- SEÇÃO 4: AVALIAÇÕES (ATUALIZADA) -->
            <section id="avaliacoes" class="my-24">
                <h2 class="text-3xl font-bold text-center text-gray-800">Feito para quem precisa de resultados</h2>
                <p class="text-lg text-center text-gray-600 mt-2 mb-12">Veja o que os nossos usuários estão a dizer.</p>

                <div class="space-y-4">
                    <!-- Scroller 1: Esquerda para Direita -->
                    <div class="scroller">
                        <ul class="scroller__inner list-none p-0">
                            <li class="flex-shrink-0 w-80 bg-white p-6 rounded-lg shadow-md">
                                <p class="text-gray-700">"Ferramenta incrível! Consegui criar um currículo super profissional em 10 minutos. A ajuda da IA para o resumo foi a cereja no topo do bolo."</p>
                                <p class="font-semibold text-right mt-4">- Mariana S., Marketing Digital</p>
                            </li>
                            <li class="flex-shrink-0 w-80 bg-white p-6 rounded-lg shadow-md">
                                <p class="text-gray-700">"Para quem está a começar a carreira, como eu, este site é uma mão na roda. Templates limpos e muito fáceis de usar. 10/10!"</p>
                                <p class="font-semibold text-right mt-4">- João P., Estudante</p>
                            </li>
                            <li class="flex-shrink-0 w-80 bg-white p-6 rounded-lg shadow-md">
                                <p class="text-gray-700">"Finalmente um gerador de currículos que não tenta vender-me um plano premium a cada clique. Gratuito e de alta qualidade. Recomendo!"</p>
                                <p class="font-semibold text-right mt-4">- Carlos F., Desenvolvedor Jr.</p>
                            </li>
                            <li class="flex-shrink-0 w-80 bg-white p-6 rounded-lg shadow-md">
                                <p class="text-gray-700">"O design minimalista era exatamente o que eu procurava. Consegui a minha primeira entrevista com o currículo que fiz aqui."</p>
                                <p class="font-semibold text-right mt-4">- Ana L., Designer Gráfica</p>
                            </li>
                             <li class="flex-shrink-0 w-80 bg-white p-6 rounded-lg shadow-md">
                                <p class="text-gray-700">"A funcionalidade de IA para melhorar as descrições é fantástica. Poupa imenso tempo e o resultado fica muito mais profissional."</p>
                                <p class="font-semibold text-right mt-4">- Ricardo G., Gerente de Projetos</p>
                            </li>
                            <li class="flex-shrink-0 w-80 bg-white p-6 rounded-lg shadow-md">
                                <p class="text-gray-700">"Usei a ferramenta para atualizar o meu currículo antigo e a diferença é notória. A interface é super intuitiva e o resultado final é excelente."</p>
                                <p class="font-semibold text-right mt-4">- Sofia B., Advogada</p>
                            </li>
                        </ul>
                    </div>
                    
                    <!-- Scroller 2: Direita para Esquerda -->
                    <div class="scroller" data-direction="right">
                        <ul class="scroller__inner list-none p-0">
                             <li class="flex-shrink-0 w-80 bg-white p-6 rounded-lg shadow-md">
                                <p class="text-gray-700">"A funcionalidade de IA para melhorar as descrições é fantástica. Poupa imenso tempo e o resultado fica muito mais profissional."</p>
                                <p class="font-semibold text-right mt-4">- Ricardo G., Gerente de Projetos</p>
                            </li>
                            <li class="flex-shrink-0 w-80 bg-white p-6 rounded-lg shadow-md">
                                <p class="text-gray-700">"Usei a ferramenta para atualizar o meu currículo antigo e a diferença é notória. A interface é super intuitiva e o resultado final é excelente."</p>
                                <p class="font-semibold text-right mt-4">- Sofia B., Advogada</p>
                            </li>
                             <li class="flex-shrink-0 w-80 bg-white p-6 rounded-lg shadow-md">
                                <p class="text-gray-700">"O design minimalista era exatamente o que eu procurava. Consegui a minha primeira entrevista com o currículo que fiz aqui."</p>
                                <p class="font-semibold text-right mt-4">- Ana L., Designer Gráfica</p>
                            </li>
                             <li class="flex-shrink-0 w-80 bg-white p-6 rounded-lg shadow-md">
                                <p class="text-gray-700">"Ferramenta incrível! Consegui criar um currículo super profissional em 10 minutos. A ajuda da IA para o resumo foi a cereja no topo do bolo."</p>
                                <p class="font-semibold text-right mt-4">- Mariana S., Marketing Digital</p>
                            </li>
                            <li class="flex-shrink-0 w-80 bg-white p-6 rounded-lg shadow-md">
                                <p class="text-gray-700">"Para quem está a começar a carreira, como eu, este site é uma mão na roda. Templates limpos e muito fáceis de usar. 10/10!"</p>
                                <p class="font-semibold text-right mt-4">- João P., Estudante</p>
                            </li>
                            <li class="flex-shrink-0 w-80 bg-white p-6 rounded-lg shadow-md">
                                <p class="text-gray-700">"Finalmente um gerador de currículos que não tenta vender-me um plano premium a cada clique. Gratuito e de alta qualidade. Recomendo!"</p>
                                <p class="font-semibold text-right mt-4">- Carlos F., Desenvolvedor Jr.</p>
                            </li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- SEÇÃO 5: CHAMADA FINAL -->
            <section id="final" class="text-center my-24 bg-white p-12 rounded-lg shadow-md">
                 <h2 class="text-3xl font-bold gradient-text">Pronto para dar o próximo passo na sua carreira?</h2>
                 <p class="text-lg text-gray-600 mt-4 max-w-3xl mx-auto">A sua jornada profissional merece um currículo à altura. Comece agora e crie um documento que abre portas.</p>
                 <a href="#gerador" class="mt-8 inline-block btn-primary text-white font-bold py-3 px-8 rounded-full shadow-lg transition-all duration-300">Começar Agora</a>
            </section>

        </main>
    </div>

    <footer class="bg-gray-900 text-white py-10 md:py-12">
        <div class="container mx-auto px-4 max-w-7xl">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-6 md:mb-0 text-center md:text-left">
                    <div class="mb-4 mx-auto md:mx-0" style="width: fit-content;">
                        <img src="https://i.postimg.cc/D0pp6j3q/Subcabe-alho-39.png" alt="Vel Sites Logo Rodapé" class="footer-logo">
                    </div>
                    <p class="text-gray-400 max-w-md">A Vel nasceu pra quem não espera, pra quem resolve. Se você move o mundo com seu ofício, a gente move sua marca no digital.</p>
                </div>
                <div class="flex flex-col md:flex-row space-y-6 md:space-y-0 md:space-x-12 text-center md:text-left">
                    <div>
                        <h4 class="font-bold text-lg mb-4">Contacto</h4>
                        <ul class="space-y-2">
                            <li class="text-gray-400">(37) 98416-9386</li>
                            <li class="text-gray-400">contato@velsites.com.br</li>
                        </ul>
                    </div>
                     <div>
                        <h4 class="font-bold text-lg mb-4">Siga-nos</h4>
                        <div class="flex space-x-4 justify-center md:justify-start">
                            <a href="https://www.instagram.com/velsites.com.br/" target="_blank" class="w-10 h-10 rounded-full bg-white/20 flex items-center justify-center footer-social-icon"><svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.067.06 1.407.06 4.123v.08c0 2.643-.012 2.987-.06 4.043-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.067.048-1.407.06-4.123.06h-.08c-2.643 0-2.987-.012-4.043-.06-1.064-.049-1.791-.218-2.427-.465a4.902 4.902 0 01-1.772-1.153 4.902 4.902 0 01-1.153-1.772c-.247-.636-.416-1.363-.465-2.427-.047-1.024-.06-1.379-.06-3.808v-.63c0-2.43.013-2.784.06-3.808.049-1.064.218-1.791.465-2.427a4.902 4.902 0 011.153-1.772A4.902 4.902 0 015.45 2.525c.636-.247 1.363-.416 2.427-.465C8.901 2.013 9.256 2 11.685 2h.63zm-.081 1.802h-.468c-2.456 0-2.784.011-3.807.058-.975.045-1.504.207-1.857.344-.467.182-.8.398-1.15.748-.35.35-.566.683-.748 1.15-.137.353-.3.882-.344 1.857-.047 1.023-.058 1.351-.058 3.807v.468c0 2.456.011 2.784.058 3.807.045.975.207 1.504.344 1.857.182.466.399.8.748 1.15.35.35.683.566 1.15.748.353.137.882.3 1.857.344 1.054.048 1.37.058 4.041.058h.08c2.597 0 2.917-.01 3.96-.058.976-.045 1.505-.207 1.858-.344.466-.182.8-.398 1.15-.748.35-.35.566-.683.748-1.15.137-.353-.3-.882.344-1.857.048-1.055.058-1.37.058-4.041v-.08c0-2.597-.01-2.917-.058-3.96-.045-.976-.207-1.505-.344-1.858a3.097 3.097 0 00-.748-1.15 3.098 3.098 0 00-1.15-.748c-.353-.137-.882-.3-1.857-.344-1.023-.047-1.351-.058-3.807-.058zM12 6.865a5.135 5.135 0 110 10.27 5.135 5.135 0 010-10.27zm0 1.802a3.333 3.333 0 100 6.666 3.333 3.333 0 000-6.666zm5.338-3.205a1.2 1.2 0 110 2.4 1.2 1.2 0 010-2.4z" clip-rule="evenodd"></path></svg></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-10 pt-6 text-center text-gray-400">
                <p>&copy; 2025 Vel Sites. Todos os direitos reservados. Site criado por Vel Sites - Criador de Site em Nova Serrana.</p>
            </div>
        </div>
    </footer>

    <!-- ADICIONADO: Estrutura do Modal de Seleção (invisível por padrão) -->
    <div id="selection-modal-overlay" class="hidden"></div>
    <div id="selection-modal-content" class="hidden">
        <div class="flex justify-between items-center p-4 border-b">
            <h3 id="selection-modal-title" class="text-lg font-semibold">Selecione uma opção</h3>
            <button id="selection-modal-close" type="button" class="text-gray-400 hover:text-gray-600">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </button>
        </div>
        <div id="selection-modal-options" class="py-2">
            <!-- Opções serão injetadas aqui pelo JavaScript -->
        </div>
    </div>
    <!-- Fim do Modal -->


    <script type="module">
        // ADICIONADO: Flag para controlar o modo demo
        let isDemoMode = true;

        document.addEventListener('DOMContentLoaded', async () => {
            // SOLUÇÃO DEFINITIVA: Espera que todas as fontes da página (incluindo 'Poppins')
            // estejam completamente carregadas antes de executar qualquer outro código.
            // Isto garante que o html2canvas sempre "verá" o texto com a fonte correta.
            await document.fonts.ready;
            
            // ADICIONADO: Ativa o modo demo ao carregar
            // A classe é adicionada ao #resume-preview, não ao body
            const resumePreview = document.getElementById('resume-preview');
            resumePreview.classList.add('is-demo-mode');


            const form = document.getElementById('resume-form');
            // const resumePreview = document.getElementById('resume-preview'); // Já definido acima
            const templateSelector = document.getElementById('template-selector');
            const colorPalette = document.getElementById('color-palette');

            let wizardSteps = [];
            let currentStep = 0;
            const prevStepButton = document.getElementById('prev-step-button');
            const nextStepButton = document.getElementById('next-step-button');
            const stepInfo = document.getElementById('wizard-step-info');
            const stepTitle = document.getElementById('wizard-step-title');
            const progressBar = document.getElementById('wizard-progress-bar');
            const stepsContainer = document.getElementById('wizard-steps-container');
            
            const formContainer = document.querySelector('.form-container');
            const completionView = document.getElementById('completion-view');

            // --- LÓGICA DE ESCALA DA PRÉ-VISUALIZAÇÃO ---
            const previewWrapper = document.getElementById('preview-wrapper');
            
            // --- ADICIONADO: LÓGICA DO QR CODE (MOVIDO PARA CIMA PARA CORRIGIR ERRO) ---
            const qrCodeContainer = document.getElementById('whatsapp-qr-code-container');
            const qrCodeImg = document.getElementById('qr-code-img');
            // ADICIONADO: Variável para o checkbox do QR Code
            const showQrCheckbox = document.getElementById('show-whatsapp-qr');

            // --- ADICIONADO: LÓGICA DA FOTO DE PERFIL ---
            const profilePicUpload = document.getElementById('profile-pic-upload');
            const profilePicContainer = document.getElementById('profile-pic-container');
            const profilePicImg = document.getElementById('profile-pic-img');
            const profilePicLabel = document.getElementById('profile-pic-label');

            if (profilePicUpload) {
                profilePicUpload.addEventListener('change', (e) => {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = (event) => {
                            profilePicImg.src = event.target.result;
                            profilePicContainer.style.display = 'block';
                            // Atualiza o texto do botão para mostrar que foi carregado
                            profilePicLabel.innerHTML = `
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check"><polyline points="20 6 9 17 4 12"/></svg>
                                Foto Carregada
                            `;
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }
            // --- FIM DA LÓGICA DA FOTO ---


            // ALTERAÇÃO: Função do QR Code atualizada para a lógica do +55
            async function generateOrUpdateQRCode(phoneNumber) {
                // ALTERAÇÃO: Adicionada verificação do checkbox
                if (!qrCodeContainer || !qrCodeImg || !window.QRCode || !showQrCheckbox) return;

                // 1. Limpa a máscara e obtém apenas os dígitos
                const cleanedPhone = phoneNumber.replace(/\D/g, ''); 
                
                // 2. Verifica se tem 10 ou 11 dígitos (DDD + número)
                // ALTERAÇÃO: Adicionada verificação do checkbox
                if (cleanedPhone.length < 10 || cleanedPhone.length > 11 || !showQrCheckbox.checked) {
                     qrCodeContainer.style.display = 'none';
                     qrCodeImg.src = '';
                     return;
                }

                // 3. Adiciona o DDI 55 (Brasil) incondicionalmente
                const finalPhone = `55${cleanedPhone}`;
                const whatsappLink = `https://wa.me/${finalPhone}`;
                
                try {
                    // 4. Gera o QR Code
                    const dataUrl = await QRCode.toDataURL(whatsappLink, { 
                        errorCorrectionLevel: 'M', // Nível de correção médio
                        margin: 2, // Margem pequena
                        width: 80 // Tamanho fixo de 80px
                    });
                    qrCodeImg.src = dataUrl; // Define a imagem
                    qrCodeContainer.style.display = 'flex'; // Mostra o container
                } catch (err) {
                    console.error('Erro ao gerar QR Code:', err);
                    qrCodeContainer.style.display = 'none';
                    qrCodeImg.src = '';
                }
            }
            // --- FIM DA ALTERAÇÃO DO QR CODE ---

            function scalePreview() {
                if (!previewWrapper || !resumePreview) return;
                
                const wrapperWidth = previewWrapper.offsetWidth;
                const baseWidth = 794; // Largura base A4 em px
                const baseHeight = 1123; // Altura base A4 em px
                
                const scale = wrapperWidth / baseWidth;
                
                resumePreview.style.transform = `scale(${scale})`;
                previewWrapper.style.height = `${baseHeight * scale}px`;
            }

            // Ligar a função
            window.addEventListener('resize', scalePreview);
            setTimeout(scalePreview, 100); // Garante a escala inicial correta

            // --- WIZARD LOGIC ---

            // ADICIONADO: Função para limpar dados do demo e preparar para edição
            function clearDemoData() {
                // ALTERAÇÃO: Adiciona placeholders em vez de limpar completamente
                document.getElementById('resume-name').textContent = 'Seu Nome';
                document.getElementById('resume-job-title').textContent = 'Cargo Desejado';
                document.getElementById('resume-email').textContent = '';
                document.getElementById('resume-phone').textContent = '';
                document.getElementById('resume-address').textContent = '';
                document.getElementById('resume-age').textContent = ''; // ALTERAÇÃO: Antigo 'resume-linkedin'
                // ADICIONADO: Limpa o estado civil
                document.getElementById('resume-marital-status').textContent = '';
                // ADICIONADO: Limpa a CNH
                document.getElementById('resume-cnh').textContent = '';
                document.getElementById('resume-summary').textContent = '';
                document.getElementById('resume-experience-list').innerHTML = '';
                document.getElementById('resume-education-list').innerHTML = '';
                document.getElementById('resume-skills').innerHTML = '';
                // ALTERAÇÃO: Garante que a seção de habilidades fique visível
                document.getElementById('skills-section').style.display = 'block';

                // ADICIONADO: Limpa o QR Code
                generateOrUpdateQRCode('');
                // ADICIONADO: Reseta o checkbox do QR Code
                if (showQrCheckbox) showQrCheckbox.checked = true;

                // ADICIONADO: Reseta a foto de perfil
                if (profilePicImg) profilePicImg.src = '';
                if (profilePicContainer) profilePicContainer.style.display = 'none';
                if (profilePicLabel) {
                    profilePicLabel.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-upload"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="17 8 12 3 7 8"/><line x1="12" y1="3" x2="12" y2="15"/></svg>
                        Carregar Foto
                    `;
                }

                // ADICIONADO: Desmarca botões da grelha de seleção
                // document.querySelectorAll('.selection-grid-btn').forEach(btn => btn.classList.remove('selected'));
                // ALTERAÇÃO: Limpa os inputs de texto
                const maritalStatusInput = document.getElementById('marital-status');
                const cnhInput = document.getElementById('cnh');
                if (maritalStatusInput) maritalStatusInput.value = '';
                if (cnhInput) cnhInput.value = '';


                // Esconde os containers de contacto que agora estão vazios
                // ALTERAÇÃO: 'linkedin' substituído por 'age' e 'marital-status' e 'cnh' adicionados
                ['email', 'phone', 'address', 'age', 'marital-status', 'cnh'].forEach(field => { 
                     document.getElementById(`resume-${field}-container`).style.display = 'none';
                });

                // Adiciona os primeiros campos vazios no formulário
                addExperience();
                addEducation();
                updateDynamicSections(); // Garante que as seções de exp/edu fiquem visíveis
            }

            // ADICIONADO: Função para gerir a transição
            function startTransitionToLiveMode() {
                isDemoMode = false;
                resumePreview.classList.add('is-fading-out'); // Adiciona classe no preview

                setTimeout(() => {
                    resumePreview.classList.remove('is-demo-mode', 'is-fading-out');
                    clearDemoData();
                    // Agora sim, avança para o próximo passo
                    showStep(currentStep + 1);
                }, 300); // Duração da animação fadeOut (0.3s)
            }

            function initWizard() {
                wizardSteps = Array.from(form.querySelectorAll('fieldset'));
                form.querySelectorAll('input, textarea').forEach(el => el.classList.add('rounded-lg'));
                
                prevStepButton.onclick = () => { if (currentStep > 0) showStep(currentStep - 1); };
                
                // ALTERADO: Lógica do botão "Próximo" para lidar com o modo demo
                nextStepButton.onclick = () => {
                    if (isDemoMode && currentStep === 0) {
                        startTransitionToLiveMode();
                    } else if (currentStep < wizardSteps.length - 1) {
                        showStep(currentStep + 1);
                    } else {
                        showCompletionView();
                    }
                };

                showStep(0);
            }

            // ADICIONADO: Função para aplicar a máscara no campo de telefone
            function formatPhoneNumberInput(e) {
                let value = e.target.value.replace(/\D/g, ''); // Remove tudo que não é dígito
                
                if (value.length > 11) {
                    value = value.substring(0, 11); // Limita a 11 dígitos
                }
                
                // Aplica a máscara (XX) X XXXX-XXXX (celular) ou (XX) XXXX-XXXX (fixo)
                if (value.length > 10) {
                    // (XX) X XXXX-XXXX
                    value = value.replace(/^(\d{2})(\d{1})(\d{4})(\d{4})$/, '($1) $2 $3-$4');
                } else if (value.length > 6) {
                    // (XX) XXXX-XXXX
                    value = value.replace(/^(\d{2})(\d{4})(\d{0,4})$/, '($1) $2-$3');
                } else if (value.length > 2) {
                    // (XX) XXXX
                    value = value.replace(/^(\d{2})(\d{0,4})$/, '($1) $2');
                } else if (value.length > 0) {
                    // (XX
                    value = value.replace(/^(\d{0,2})$/, '($1');
                }
                
                e.target.value = value;
            }
            // --- FIM DA FUNÇÃO ADICIONADA ---

            // ADICIONADO: Função reutilizável para grelhas de seleção
            // ALTERAÇÃO: Lógica removida.
            // function setupSelectionGrid(gridId, inputId) { ... }
            
            // --- ADICIONADO: LÓGICA DO MODAL DE SELEÇÃO ---
            const modalOverlay = document.getElementById('selection-modal-overlay');
            const modalContent = document.getElementById('selection-modal-content');
            const modalTitle = document.getElementById('selection-modal-title');
            const modalOptionsContainer = document.getElementById('selection-modal-options');
            const modalCloseBtn = document.getElementById('selection-modal-close');

            let currentModalInput = null; // Guarda o input que abriu o modal

            function openSelectionModal(inputId, title, options) {
                currentModalInput = document.getElementById(inputId);
                if (!currentModalInput) return;

                modalTitle.textContent = title;
                modalOptionsContainer.innerHTML = ''; // Limpa opções antigas

                options.forEach(option => {
                    const button = document.createElement('button');
                    button.type = 'button';
                    button.className = 'modal-option-btn';
                    button.textContent = option;
                    button.dataset.value = option;
                    modalOptionsContainer.appendChild(button);
                });

                modalOverlay.classList.remove('hidden');
                modalContent.classList.remove('hidden');
            }

            function closeSelectionModal() {
                modalOverlay.classList.add('hidden');
                modalContent.classList.add('hidden');
                currentModalInput = null;
            }

            // Listeners para fechar o modal
            modalCloseBtn.addEventListener('click', closeSelectionModal);
            modalOverlay.addEventListener('click', closeSelectionModal);

            // Listener para selecionar uma opção
            modalOptionsContainer.addEventListener('click', (e) => {
                const button = e.target.closest('.modal-option-btn');
                if (button && currentModalInput) {
                    currentModalInput.value = button.dataset.value;
                    // Dispara o evento 'input' para atualizar a pré-visualização
                    currentModalInput.dispatchEvent(new Event('input', { bubbles: true }));
                    closeSelectionModal();
                }
            });

            // Listeners para abrir o modal
            document.getElementById('marital-status').addEventListener('click', () => {
                const options = ['Solteiro(a)', 'Casado(a)', 'Divorciado(a)', 'Viúvo(a)'];
                openSelectionModal('marital-status', 'Selecione o Estado Civil', options);
            });

            document.getElementById('cnh').addEventListener('click', () => {
                const options = ['Não possuo', 'A', 'B', 'A+B', 'C', 'D', 'E'];
                openSelectionModal('cnh', 'Selecione a Categoria da CNH', options);
            });
            // --- FIM DA LÓGICA DO MODAL ---


            function showStep(stepIndex) {
                if (stepIndex < 0 || stepIndex >= wizardSteps.length) return;

                wizardSteps.forEach((step, index) => {
                    step.classList.toggle('step-active', index === stepIndex);
                });

                const nextStepElement = wizardSteps[stepIndex];

                requestAnimationFrame(() => {
                    if (nextStepElement) {
                        stepsContainer.style.height = `${nextStepElement.scrollHeight}px`;
                    }
                });
                
                currentStep = stepIndex;
                updateWizardControls();
            }

            function updateWizardControls() {
                const topic = wizardSteps[currentStep].querySelector('legend').textContent;
                stepInfo.textContent = `Passo ${currentStep + 1} de ${wizardSteps.length}`;
                stepTitle.textContent = topic;
                progressBar.style.width = `${((currentStep + 1) / wizardSteps.length) * 100}%`;
                prevStepButton.disabled = currentStep === 0;
                
                // ALTERADO: Muda o texto do botão no modo demo
                if (isDemoMode && currentStep === 0) {
                    nextStepButton.textContent = 'Começar'; // <-- Texto alterado
                } else {
                    nextStepButton.textContent = currentStep === wizardSteps.length - 1 ? 'Concluir' : 'Próximo';
                }
            }
            
            initWizard();

            // ADICIONADO: Ativa as grelhas de seleção
            // ALTERAÇÃO: Lógica removida
            // setupSelectionGrid('marital-status-grid', 'marital-status');
            // setupSelectionGrid('cnh-grid', 'cnh');

            // ADICIONADO: Atribui a função de máscara ao campo de telefone
            document.getElementById('phone').addEventListener('input', formatPhoneNumberInput);

            // ADICIONADO: Restringe o campo de idade para aceitar apenas números
            document.getElementById('age').addEventListener('input', (e) => {
                let value = e.target.value.replace(/\D/g, ''); // Remove não-dígitos
                if (value.length > 2) {
                    value = value.substring(0, 2); // Limita a 2 dígitos
                }
                e.target.value = value;
            });

            // ADICIONADO: Listener para o checkbox do QR Code
            if (showQrCheckbox) {
                showQrCheckbox.addEventListener('change', () => {
                    const phoneValue = document.getElementById('phone').value;
                    generateOrUpdateQRCode(phoneValue);
                });
            }

            // ADICIONADO: Gera o QR Code para o modo demo
            if (isDemoMode) {
                // Usa o número de telefone de exemplo do HTML
                const demoPhone = document.getElementById('resume-phone').textContent;
                if (demoPhone) {
                    generateOrUpdateQRCode(demoPhone);
                }
            }

            function showCompletionView() {
                form.classList.add('hidden');
                completionView.classList.remove('hidden');

                prevStepButton.textContent = 'Voltar';
                prevStepButton.onclick = showWizardView;

                nextStepButton.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                    <span>Baixar PDF</span>`;
                nextStepButton.classList.add('flex', 'items-center', 'justify-center', 'gap-2');
                // ALTERAÇÃO: A chamada da função foi atualizada
                nextStepButton.onclick = () => exportResumeViaIframe(nextStepButton);
            }

            function showWizardView() {
                completionView.classList.add('hidden');
                form.classList.remove('hidden');

                prevStepButton.textContent = 'Anterior';
                prevStepButton.onclick = () => { if (currentStep > 0) showStep(currentStep - 1); };

                nextStepButton.innerHTML = 'Próximo';
                nextStepButton.classList.remove('flex', 'items-center', 'justify-center', 'gap-2');
                nextStepButton.onclick = () => {
                    if (currentStep < wizardSteps.length - 1) {
                        showStep(currentStep + 1);
                    } else {
                        showCompletionView();
                    }
                };
                
                showStep(wizardSteps.length - 1);
            }

            // --- LÓGICA DE ESTILO E TEMPLATE ---
            templateSelector.addEventListener('click', (e) => {
                const selectedOption = e.target.closest('.template-option');
                if (!selectedOption) return;

                document.querySelectorAll('.template-option').forEach(opt => opt.classList.replace('border-blue-600', 'border-gray-300'));
                selectedOption.classList.replace('border-gray-300', 'border-blue-600');

                const template = selectedOption.dataset.template;
                resumePreview.className = resumePreview.className.replace(/template-\w+/g, '');
                resumePreview.classList.add(template);
            });
            
            colorPalette.addEventListener('click', (e) => {
                const selectedColor = e.target.closest('.color-option');
                if (!selectedColor) return;

                document.querySelectorAll('.color-option').forEach(opt => opt.classList.replace('border-blue-600', 'border-white'));
                selectedColor.classList.replace('border-white', 'border-blue-600');
                
                document.documentElement.style.setProperty('--theme-color', selectedColor.dataset.color);
            });

            // --- ATUALIZAÇÃO EM TEMPO REAL ---
            form.addEventListener('input', (e) => {
                // ADICIONADO: Bloqueia a atualização em tempo real durante o modo demo
                if (isDemoMode) return;

                const input = e.target;
                const value = input.value;
                const targetId = input.dataset.target;

                if (!targetId) return;
                const targetElement = document.getElementById(targetId);
                if (!targetElement) return;

                switch (targetId) {
                    case 'resume-name':
                    case 'resume-job-title':
                    case 'resume-summary':
                        targetElement.textContent = value || '';
                        break;
                    
                    // ALTERAÇÃO: 'resume-linkedin' removido deste grupo
                    case 'resume-email':
                    case 'resume-phone':
                    case 'resume-address':
                        // ADICIONADO: Estado Civil
                    case 'resume-marital-status':
                        const container = document.getElementById(`${targetId}-container`);
                        // ALTERAÇÃO: 'inline-flex' mudado para 'flex' para se adaptar à grelha
                        container.style.display = value ? 'flex' : 'none'; 
                        targetElement.textContent = value;
                        // if (targetId === 'resume-linkedin') { // Lógica antiga do LinkedIn removida
                        // } else 
                        if (targetId === 'resume-email') { container.href = `mailto:${value}`; 
                        } else if (targetId === 'resume-phone') { 
                            container.href = `tel:${value}`; 
                            // ADICIONADO: Gera o QR Code em tempo real
                            generateOrUpdateQRCode(value);
                        }
                        break;

                    // ADICIONADO: Novo 'case' para formatar a idade
                    case 'resume-age':
                        const ageContainer = document.getElementById('resume-age-container');
                        // ALTERAÇÃO: 'inline-flex' mudado para 'flex'
                        ageContainer.style.display = value ? 'flex' : 'none';
                        targetElement.textContent = value ? `${value} anos` : '';
                        break;
                    
                    // ADICIONADO: Novo 'case' para formatar a CNH
                    case 'resume-cnh':
                        const cnhContainer = document.getElementById('resume-cnh-container');
                        cnhContainer.style.display = value ? 'flex' : 'none';
                        targetElement.textContent = value ? (value === 'Não possuo' ? 'Não Habilitado' : `CNH: ${value}`) : '';
                        break;

                    case 'resume-skills':
                        targetElement.innerHTML = ''; // Limpa as habilidades existentes
                        const skillsArray = value.split(',').map(skill => skill.trim()).filter(skill => skill);
                        const skillsSection = document.getElementById('skills-section');
                        if (skillsArray.length > 0) {
                            skillsSection.style.display = 'block';
                            skillsArray.forEach(skillText => {
                                const pill = document.createElement('span');
                                pill.textContent = skillText;
                                pill.className = 'inline-block h-7 leading-7 bg-gray-200 rounded-full px-4 text-sm font-semibold text-gray-700 mr-2 mb-2 align-top';
                                targetElement.appendChild(pill);
                            });
                        } else {
                            // ALTERAÇÃO: Não esconde mais a seção, apenas limpa o conteúdo
                            skillsSection.style.display = 'block';
                            targetElement.innerHTML = ''; 
                        }
                        break;
                }
            });

            // ALTERADO: Não executa esta parte se estiver no modo demo (será chamado após a transição)
            if (!isDemoMode) {
                // ALTERAÇÃO: 'linkedin' substituído por 'age' e 'marital-status' e 'cnh' adicionados
                ['email', 'phone', 'address', 'age', 'marital-status', 'cnh'].forEach(field => {
                    document.getElementById(`resume-${field}-container`).style.display = 'none';
                });
            }
            
            // --- SEÇÕES DINÂMICAS (ACORDEÃO) ---
            let experienceCount = 0;
            let educationCount = 0;

            const addExperience = () => {
                // ADICIONADO: Bloqueia a adição de campos no modo demo
                if (isDemoMode) return;

                experienceCount++;
                const list = document.getElementById('experience-list');
                const newItem = document.createElement('div');
                newItem.className = 'accordion-item bg-white border rounded-lg shadow-sm';
                newItem.dataset.id = experienceCount;
                newItem.dataset.type = 'experience';
                newItem.innerHTML = `
                    <div class="accordion-header p-4 flex justify-between items-center cursor-pointer">
                        <div class="flex-grow">
                            <h4 class="font-semibold text-gray-800 accordion-title">Nova Experiência</h4>
                            <p class="text-sm text-gray-500 accordion-subtitle"></p>
                        </div>
                        <div class="flex items-center gap-2">
                            <button type="button" class="remove-section-btn text-gray-400 hover:text-red-500 transition-colors" title="Remover Experiência">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash-2"><path d="M3 6h18"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>
                            </button>
                            <svg class="accordion-chevron w-5 h-5 text-gray-500 transition-transform transform" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                        </div>
                    </div>
                    <div class="accordion-body p-4 border-t border-gray-200 hidden">
                        <div class="space-y-3">
                             <input type="text" placeholder="Cargo" class="w-full p-2 border rounded-lg experience-job-title">
                            <input type="text" placeholder="Empresa" class="w-full p-2 border rounded-lg experience-company">
                            <input type="text" placeholder="Local (Ex: São Paulo, SP)" class="w-full p-2 border rounded-lg experience-location">
                            <div class="flex gap-3">
                                <input type="text" placeholder="Início (Ex: Jan 2020)" class="w-1/2 p-2 border rounded-lg experience-start-date">
                                <input type="text" placeholder="Fim (Ex: Atual)" class="w-1/2 p-2 border rounded-lg experience-end-date">
                            </div>
                            
                            <!-- ALTERAÇÃO: Removido o 'div relative' e o botão de dentro da textarea -->
                            <textarea placeholder="Principais responsabilidades e conquistas..." class="w-full p-2 border rounded-lg h-24 experience-description"></textarea>
                            
                            <!-- ALTERAÇÃO: Adicionado botão de IA e texto de instrução (com estilo mais leve) -->
                            <button type="button" title="Melhorar com IA" class="enhance-experience mt-2 w-full flex items-center justify-center gap-2 bg-indigo-100 text-indigo-700 font-semibold py-2 px-4 rounded-full hover:bg-indigo-200 transition-colors text-sm">
                                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sparkles"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M19 17v4"/><path d="M3 5h4"/><path d="M17 19h4"/></svg>
                                Escrever com IA
                            </button>
                            <p class="text-xs text-gray-500 mt-2 text-center">Descreva suas atividades e clique no botão para a IA aprimorar o texto.</p>
                            <!-- Fim da Alteração -->

                        </div>
                    </div>
                `;
                list.appendChild(newItem);
                if (list.children.length === 1) {
                    newItem.querySelector('.accordion-body').classList.remove('hidden');
                    newItem.querySelector('.accordion-chevron').classList.add('rotate-180');
                }
                updateDynamicSections();
            };

            const addEducation = () => {
                // ADICIONADO: Bloqueia a adição de campos no modo demo
                if (isDemoMode) return;

                educationCount++;
                const list = document.getElementById('education-list');
                const newItem = document.createElement('div');
                newItem.className = 'accordion-item bg-white border rounded-lg shadow-sm';
                newItem.dataset.id = educationCount;
                newItem.dataset.type = 'education';
                newItem.innerHTML = `
                     <div class="accordion-header p-4 flex justify-between items-center cursor-pointer">
                        <div class="flex-grow">
                            <h4 class="font-semibold text-gray-800 accordion-title">Nova Formação</h4>
                            <p class="text-sm text-gray-500 accordion-subtitle"></p>
                        </div>
                        <div class="flex items-center gap-2">
                             <button type="button" class="remove-section-btn text-gray-400 hover:text-red-500 transition-colors" title="Remover Formação">
                                <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-trash-2"><path d="M3 6h18"/><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/><line x1="10" y1="11" x2="10" y2="17"/><line x1="14" y1="11" x2="14" y2="17"/></svg>
                            </button>
                             <svg class="accordion-chevron w-5 h-5 text-gray-500 transition-transform transform" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd" /></svg>
                        </div>
                    </div>
                    <div class="accordion-body p-4 border-t border-gray-200 hidden">
                        <div class="space-y-3">
                            <input type="text" placeholder="Curso/Formação (Ex: Bacharelado)" class="w-full p-2 border rounded-lg education-degree">
                            <input type="text" placeholder="Instituição de Ensino" class="w-full p-2 border rounded-lg education-institution">
                            <div class="flex gap-3">
                                 <!-- ALTERAÇÃO: Adicionada classe 'numeric-input' -->
                                 <input type="text" placeholder="Início (Ex: 2016)" class="w-full p-2 border rounded-lg education-start-date numeric-input">
                                 <!-- ALTERAÇÃO: Adicionada classe 'numeric-input' -->
                                 <input type="text" placeholder="Fim (Ex: 2020)" class="w-full p-2 border rounded-lg education-end-date numeric-input">
                            </div>
                        </div>
                    </div>
                `;
                list.appendChild(newItem);
                if (list.children.length === 1) {
                    newItem.querySelector('.accordion-body').classList.remove('hidden');
                    newItem.querySelector('.accordion-chevron').classList.add('rotate-180');
                }
                updateDynamicSections();
            };
            
            // MELHORIA: A lógica do acordeão foi centralizada para ser mais eficiente.
            function setupAccordionListeners(containerId) {
                const container = document.getElementById(containerId);
                container.addEventListener('click', (e) => {
                    // ADICIONADO: Bloqueia o acordeão no modo demo
                    if (isDemoMode) return;
                    
                    const removeButton = e.target.closest('.remove-section-btn');
                    const header = e.target.closest('.accordion-header');

                    if (removeButton) {
                        const itemToRemove = removeButton.closest('.accordion-item');
                        if (itemToRemove) {
                            itemToRemove.remove();
                            updateDynamicSections();
                            setTimeout(() => showStep(currentStep), 200); // Recalcula altura
                            
                            // ADICIONADO: Desmarca botões de atalho se a lista ficar vazia
                            const educationList = document.getElementById('education-list');
                            if (educationList.children.length === 0) {
                                document.querySelectorAll('.education-shortcut-btn').forEach(btn => btn.classList.remove('selected'));
                            }
                        }
                        return; // Impede que o acordeão abra/feche ao remover
                    }
                    
                    if (header) {
                        const item = header.parentElement;
                        const body = item.querySelector('.accordion-body');
                        const chevron = header.querySelector('.accordion-chevron');
                        
                        const isHidden = body.classList.toggle('hidden');
                        chevron.classList.toggle('rotate-180', !isHidden);
                        setTimeout(() => showStep(currentStep), 200); // Recalcula altura
                    }
                });

                container.addEventListener('input', (e) => {
                    // ADICIONADO: Bloqueia o acordeão no modo demo
                    if (isDemoMode) return;

                    const item = e.target.closest('.accordion-item');
                    if (!item) return;

                    const titleEl = item.querySelector('.accordion-title');
                    const subtitleEl = item.querySelector('.accordion-subtitle');

                    if (containerId === 'experience-list') {
                        const jobTitle = item.querySelector('.experience-job-title').value || 'Nova Experiência';
                        const company = item.querySelector('.experience-company').value || '';
                        titleEl.textContent = jobTitle;
                        subtitleEl.textContent = company;
                    } else { // education-list
                        const degree = item.querySelector('.education-degree').value || 'Nova Formação';
                        const institution = item.querySelector('.education-institution').value || '';
                        titleEl.textContent = degree;
                        subtitleEl.textContent = institution;
                    }
                });

                // ADICIONADO: Listener para forçar apenas números nos campos de data da formação
                if (containerId === 'education-list') {
                    container.addEventListener('input', (e) => {
                        if (e.target.classList.contains('numeric-input')) {
                            e.target.value = e.target.value.replace(/\D/g, '');
                        }

                        // ADICIONADO: Desmarca botões de atalho se o campo for editado manually
                        if (e.target.classList.contains('education-degree')) {
                            document.querySelectorAll('.education-shortcut-btn').forEach(btn => btn.classList.remove('selected'));
                        }
                    });
                }
            }

            setupAccordionListeners('experience-list');
            setupAccordionListeners('education-list');

            const updateDynamicSections = () => {
                // ADICIONADO: Bloqueia a atualização no modo demo
                if (isDemoMode) return;

                // Atualiza Experiência
                const experienceFormItems = document.querySelectorAll('#experience-list > .accordion-item');
                const experienceResumeList = document.getElementById('resume-experience-list');
                const experienceSection = document.getElementById('experience-section');
                
                experienceResumeList.innerHTML = '';
                experienceFormItems.forEach(item => {
                    const jobTitle = item.querySelector('.experience-job-title').value;
                    const company = item.querySelector('.experience-company').value;
                    if (jobTitle || company) {
                        const location = item.querySelector('.experience-location').value;
                        const startDate = item.querySelector('.experience-start-date').value;
                        const endDate = item.querySelector('.experience-end-date').value;
                        const description = item.querySelector('.experience-description').value.replace(/\n/g, '<br>');
                        experienceResumeList.innerHTML += `
                            <div>
                                <div class="flex justify-between items-baseline flex-wrap">
                                    <div class="pr-4">
                                        <h4 class="text-lg font-semibold">${jobTitle}</h4>
                                        <p class="text-md text-gray-700">${company} ${location ? `&bull; ${location}` : ''}</p>
                                    </div>
                                    <p class="text-sm text-gray-500 text-right whitespace-nowrap">${startDate} ${startDate && endDate ? ' - ' : ''} ${endDate}</p>
                                </div>
                                ${description ? `<p class="mt-2 text-gray-600 leading-relaxed">${description}</p>` : ''}
                            </div>
                        `;
                    }
                });
                // MELHORIA: Esconde a seção no preview se estiver vazia
                // ALTERAÇÃO: A seção agora fica sempre visível
                experienceSection.style.display = 'block';

                // Atualiza Formação
                const educationFormItems = document.querySelectorAll('#education-list > .accordion-item');
                const educationResumeList = document.getElementById('resume-education-list');
                const educationSection = document.getElementById('education-section');

                educationResumeList.innerHTML = '';
                educationFormItems.forEach(item => {
                    const degree = item.querySelector('.education-degree').value;
                    const institution = item.querySelector('.education-institution').value;
                    if(degree || institution) {
                        const startDate = item.querySelector('.education-start-date').value;
                        const endDate = item.querySelector('.education-end-date').value;
                        educationResumeList.innerHTML += `
                            <div>
                                <div class="flex justify-between items-baseline flex-wrap">
                                    <div class="pr-4">
                                        <h4 class="text-lg font-semibold">${degree}</h4>
                                        <p class="text-md text-gray-700">${institution}</p>
                                    </div>
                                    <p class="text-sm text-gray-500 text-right whitespace-nowrap">${startDate} ${startDate && endDate ? ' - ' : ''} ${endDate}</p>
                                </div>
                            </div>
                        `;
                    }
                });
                // MELHORIA: Esconde a seção no preview se estiver vazia
                // ALTERAÇÃO: A seção agora fica sempre visível
                educationSection.style.display = 'block';
            };

            // ALTERAÇÃO: Adicionado recálculo de altura ao adicionar item
            document.getElementById('add-experience').addEventListener('click', () => {
                addExperience();
                setTimeout(() => showStep(currentStep), 200); // Recalcula altura
            });
            document.getElementById('add-education').addEventListener('click', () => {
                addEducation();
                setTimeout(() => showStep(currentStep), 200); // Recalcula altura
            });
            
            form.addEventListener('input', (e) => {
                // ADICIONADO: Bloqueia a atualização no modo demo
                if (isDemoMode) return;
                
                if(e.target.closest('#experience-list') || e.target.closest('#education-list')) {
                    updateDynamicSections();
                }
            });

            // ALTERADO: Não executa esta parte se estiver no modo demo (será chamado após a transição)
            if (!isDemoMode) {
                // addExperience(); // Movido para clearDemoData
                // addEducation(); // Movido para clearDemoData
                updateDynamicSections(); // Chamada inicial para esconder seções vazias
            }

            // --- ADICIONADO: LÓGICA DOS ATALHOS DE FORMAÇÃO ---
            const shortcutButtons = document.querySelectorAll('.education-shortcut-btn');
            shortcutButtons.forEach(button => {
                button.addEventListener('click', () => {
                    // Pega o texto do botão
                    const degreeText = button.dataset.degree;
                    const educationList = document.getElementById('education-list');

                    // ALTERAÇÃO: Lógica para seleção única
                    // 1. Desmarca todos os botões
                    shortcutButtons.forEach(btn => btn.classList.remove('selected'));
                    // 2. Marca o botão clicado
                    button.classList.add('selected');
                    
                    // 3. Limpa a lista de formações existentes
                    educationList.innerHTML = '';

                    // 4. Chama a função existente para criar UM novo item
                    addEducation();
                    
                    // 5. Encontra o item que acabou de ser criado (o único)
                    const newItem = educationList.firstElementChild;
                    
                    if (newItem) {
                        // 6. Encontra o campo de "Curso" e preenche
                        const degreeInput = newItem.querySelector('.education-degree');
                        if (degreeInput) {
                            degreeInput.value = degreeText;
                            // Dispara o evento 'input' para atualizar o título do acordeão
                            degreeInput.dispatchEvent(new Event('input', { bubbles: true }));
                        }
                    }
                    // 7. Recalcula a altura do passo
                    setTimeout(() => showStep(currentStep), 200);
                });
            });

            // --- ADICIONADO: LÓGICA DAS SUGESTÕES DE HABILIDADES ---
            const skillsInput = document.getElementById('skills');
            const suggestionButtons = document.querySelectorAll('.skill-suggestion-btn');

            function updateSkillButtonStates() {
                const currentSkills = (skillsInput.value || '')
                    .split(',')
                    .map(s => s.trim().toLowerCase())
                    .filter(s => s);
                
                suggestionButtons.forEach(button => {
                    const skillText = button.textContent.toLowerCase();
                    button.disabled = currentSkills.includes(skillText);
                });
            }

            suggestionButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const skillText = button.textContent;
                    const currentValue = skillsInput.value.trim();
                    
                    if (currentValue) {
                        skillsInput.value = `${currentValue}, ${skillText}`;
                    } else {
                        skillsInput.value = skillText;
                    }
                    
                    // Dispara o evento 'input' para atualizar o preview e desabilitar o botão
                    skillsInput.dispatchEvent(new Event('input', { bubbles: true }));
                });
            });

            skillsInput.addEventListener('input', updateSkillButtonStates);
            // --- FIM DA LÓGICA DE SUGESTÕES ---


            // --- LÓGICA DO QR CODE ---
            // A lógica foi movida para o topo do script para evitar erros de inicialização.

            // --- LÓGICA DA IA (GEMINI) ---
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;
            const spinnerIcon = `<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>`;

            async function callGeminiAPI(prompt, button) {
                const originalButtonContent = button.innerHTML;
                button.disabled = true;
                button.innerHTML = spinnerIcon + 'Aprimorando...'; // Adiciona texto ao spinner

                try {
                    const payload = {
                        contents: [{ parts: [{ text: prompt }] }],
                        systemInstruction: { parts: [{ text: "Você é um especialista em RH que cria currículos. Sua tarefa é reescrever o texto fornecido para ser mais profissional e impactante. Responda apenas com o texto reescrito, sem introduções ou comentários." }] },
                    };
                    const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (!response.ok) throw new Error(`API error: ${response.statusText}`);
                    const result = await response.json();
                    const generatedText = result.candidates?.[0]?.content?.parts?.[0]?.text;
                    if (!generatedText) throw new Error("A IA não conseguiu gerar uma sugestão.");
                    return generatedText.trim();
                } catch (error) {
                    console.error("Erro ao chamar a API Gemini:", error);
                    return null;
                } finally {
                    button.disabled = false;
                    button.innerHTML = originalButtonContent;
                }
            }

            document.getElementById('enhance-summary').addEventListener('click', async (e) => {
                const button = e.currentTarget;
                const textarea = document.getElementById('summary');
                const text = textarea.value;
                if (!text.trim()) return;
                const prompt = `Reescreva o seguinte resumo profissional para ser mais conciso e impactante, destacando as principais qualidades: "${text}"`;
                const enhancedText = await callGeminiAPI(prompt, button);
                if (enhancedText) {
                    textarea.value = enhancedText;
                    textarea.dispatchEvent(new Event('input', { bubbles: true }));
                }
            });

            document.getElementById('experience-list').addEventListener('click', async (e) => {
                const button = e.target.closest('.enhance-experience');
                if (!button) return;
                const formItem = button.closest('.accordion-item');
                const textarea = formItem.querySelector('.experience-description');
                const jobTitle = formItem.querySelector('.experience-job-title').value;
                const text = textarea.value;
                if (!text.trim()) return;
                const prompt = `Considerando o cargo de "${jobTitle}", reescreva a seguinte descrição de experiência profissional usando verbos de ação e focando em conquistas, de forma profissional e sucinta: "${text}"`;
                const enhancedText = await callGeminiAPI(prompt, button);
                if (enhancedText) {
                    textarea.value = enhancedText;
                    // Dispara 'input' no textarea para atualizar a secção dinâmica
                    textarea.dispatchEvent(new Event('input', { bubbles: true }));
                    // E dispara 'input' no form para atualizar o preview (necessário?)
                    form.dispatchEvent(new Event('input', { bubbles: true, composed: true }));
                    updateDynamicSections(); // Força a atualização
                }
            });

            // --- EXPORTAR PARA PDF ---
            async function exportResumeAsPdf(button) {
                 const originalContent = button.innerHTML;
                button.disabled = true;
                button.innerHTML = `<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>Gerando...`;
            
                // const resumePreview = document.getElementById('resume-preview'); // Já definido no topo
                // Clona o elemento para não afetar a visualização principal
                const clone = resumePreview.cloneNode(true);
                clone.id = 'resume-clone-for-pdf';
                // Reseta transformações e move para fora da tela para renderização correta
                clone.style.transform = 'none';
                clone.style.position = 'absolute';
                clone.style.left = '-9999px';
                clone.style.top = '0';
                clone.style.zIndex = '-1';
                // Remove o modo demo para garantir que os placeholders não apareçam no PDF
                clone.classList.remove('is-demo-mode', 'is-fading-out');
                
                document.body.appendChild(clone);
                
                const resumeName = document.getElementById('name').value.trim().replace(/ /g, '_') || 'curriculo';
            
                // Pequeno delay para garantir que o DOM foi atualizado com o clone
                setTimeout(() => {
                    html2canvas(clone, { 
                        scale: 2, // Aumenta a resolução para melhor qualidade de impressão
                        useCORS: true, 
                        logging: true,
                        letterRendering: true,
                        allowTaint: true
                    }).then(canvas => {
                        try {
                            const { jsPDF } = window.jspdf;
                            const imgData = canvas.toDataURL('image/png');
                            const pdf = new jsPDF({ orientation: 'portrait', unit: 'pt', format: 'a4' });
                            const pdfWidth = pdf.internal.pageSize.getWidth();
                            const pdfHeight = pdf.internal.pageSize.getHeight();
                            
                            pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, pdfHeight);
                            pdf.save(`${resumeName}.pdf`);
            
                        } catch (pdfError) {
                            console.error("ERRO ao criar ou salvar o PDF:", pdfError);
                            // alert("Ocorreu um erro ao gerar o PDF. Verifique o console para mais detalhes.");
                        }
                    }).catch(err => {
                        console.error("ERRO no html2canvas:", err);
                        // alert("Ocorreu um erro ao renderizar o currículo. Verifique o console para mais detalhes.");
                    }).finally(() => {
                        // Limpa o clone do DOM e restaura o botão
                        document.body.removeChild(clone);
                        button.disabled = false;
                        button.innerHTML = originalContent;
                    });
                }, 100); // Reduzido o tempo de espera
            }

            // --- LÓGICA DO SCROLLER DE AVALIAÇÕES ---
            const scrollers = document.querySelectorAll(".scroller");
            if (!window.matchMedia("(prefers-reduced-motion: reduce)").matches) {
                addAnimation();
            }

            function addAnimation() {
                scrollers.forEach((scroller) => {
                    scroller.setAttribute("data-animated", true);
                    const scrollerInner = scroller.querySelector(".scroller__inner");
                    const scrollerContent = Array.from(scrollerInner.children);
                    scrollerContent.forEach((item) => {
                        const duplicatedItem = item.cloneNode(true);
                        duplicatedItem.setAttribute("aria-hidden", true);
                        scrollerInner.appendChild(duplicatedItem);
                    });
                });
            }
        });

        // --- SUBSTITUIÇÃO DA FUNÇÃO DE EXPORTAR PDF ---
        // A função 'exportResumeAsPdf' foi removida e substituída pela 'exportResumeViaIframe'.

        async function exportResumeViaIframe(button) {
            const originalContent = button.innerHTML;
            button.disabled = true;
            button.innerHTML = `<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" 
                xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" 
                stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" 
                d="M4 12a8 8 0 018-8V0C5.373 0 
                0 5.373 0 12h4zm2 5.291A7.962 
                7.962 0 014 12H0c0 3.042 1.135 
                5.824 3 7.938l3-2.647z"></path>
            </svg>Gerando...`;

            // Recolhe os dados do DOM
            const data = {
                type: 'EXPORT_CV',
                themeColor: getComputedStyle(document.documentElement)
                .getPropertyValue('--theme-color').trim(),
                name: document.getElementById('resume-name').textContent,
                role: document.getElementById('resume-job-title').textContent,
                email: document.getElementById('resume-email').textContent,
                phone: document.getElementById('resume-phone').textContent,
                address: document.getElementById('resume-address').textContent,
                age: (document.getElementById('resume-age').textContent || '').replace(/\D/g, ''),
                maritalStatus: document.getElementById('resume-marital-status').textContent,
                cnh: document.getElementById('resume-cnh').textContent,
                summary: document.getElementById('resume-summary').textContent,
                experiences: Array.from(document.querySelectorAll('#resume-experience-list > div')).map(block => ({
                    title: block.querySelector('h4')?.textContent || '',
                    company: (block.querySelector('p.text-md')?.textContent || '').split('•')[0].trim(), // Pega só a empresa
                    location: (block.querySelector('p.text-md')?.textContent || '').split('•')[1]?.trim() || '', // Pega só a localização
                    start: block.querySelector('.text-sm.text-gray-500')?.textContent.split('-')[0]?.trim() || '',
                    end: block.querySelector('.text-sm.text-gray-500')?.textContent.split('-')[1]?.trim() || '',
                    description: block.querySelector('.mt-2')?.innerHTML || '' // Usa innerHTML para manter quebras de linha
                })),
                education: Array.from(document.querySelectorAll('#resume-education-list > div')).map(block => ({
                    degree: block.querySelector('h4')?.textContent || '',
                    institution: block.querySelector('p.text-md')?.textContent || '',
                    start: block.querySelector('.text-sm.text-gray-500')?.textContent.split('-')[0]?.trim() || '',
                    end: block.querySelector('.text-sm.text-gray-500')?.textContent.split('-')[1]?.trim() || ''
                })),
                skills: Array.from(document.querySelectorAll('#resume-skills .inline-block')).map(s => s.textContent),
                profilePicDataUrl: document.getElementById('profile-pic-img')?.src || null,
                qrDataUrl: document.getElementById('qr-code-img')?.src || null
            };

            // Cria o iframe
            const iframe = document.createElement('iframe');
            iframe.style.position = 'fixed';
            iframe.style.left = '-9999px';
            iframe.src = 'export.html'; // O novo template
            document.body.appendChild(iframe);

            // Espera o iframe carregar
            await new Promise(resolve => iframe.onload = resolve);

            // Prepara-se para receber a URL do blob
            const donePromise = new Promise(resolve => {
                window.addEventListener('message', (e) => {
                if (e.data?.type === 'EXPORT_DONE') resolve(e.data.blobUrl);
                }, { once: true });
            });

            // Envia os dados para o iframe
            iframe.contentWindow.postMessage(data, '*');
            
            // Espera a resposta com a URL
            const blobUrl = await donePromise;
            document.body.removeChild(iframe);

            // Inicia o download
            const a = document.createElement('a');
            a.href = blobUrl;
            a.download = (data.name ? data.name.replace(/\s+/g, '_') : 'curriculo') + '.pdf';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);

            button.disabled = false;
            button.innerHTML = originalContent;
        }

    </script>
</body>
</html>

