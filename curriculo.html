<!DOCTYPE html>
<html lang="pt-PT">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gerador de Currículo Gratuito</title>
    <!-- Tailwind CSS --><script src="https://cdn.tailwindcss.com"></script>
    <!-- jsPDF e html2canvas para exportar PDF --><script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap');

        :root {
            --theme-color: #002e9e; /* Cor primária do Vel Sites */
            --cor-primaria: #002e9e;
            --cor-secundaria: #0078e8;
            --gradiente-texto: linear-gradient(135deg, var(--cor-primaria), var(--cor-secundaria));
        }

        body {
            font-family: 'Poppins', sans-serif;
            -webkit-print-color-adjust: exact;
            background-color: #f9fafb; /* Fundo cinza claro igual ao Vel Sites */
        }
        
        .form-container {
            display: flex;
            flex-direction: column;
            position: relative;
            min-height: 800px; /* Altura mínima para acomodar o conteúdo e a navegação fixa */
        }

        #wizard-steps-container {
            position: relative;
            flex-grow: 1;
            transition: height 0.4s ease-in-out;
        }

        #resume-form fieldset {
            transition: opacity 0.4s ease-in-out, transform 0.4s ease-in-out;
            position: absolute;
            width: 100%;
            background-color: white; /* Garante que os steps não sejam transparentes durante a transição */
        }
        
        #resume-form fieldset:not(.step-active) {
            opacity: 0;
            transform: translateX(20px);
            pointer-events: none;
        }
        
        #resume-form fieldset.step-active {
            opacity: 1;
            transform: translateX(0);
        }
        
        #wizard-header {
            border-bottom: 1px solid #e5e7eb;
            padding-bottom: 1rem;
        }

        #wizard-step-title {
            font-size: 1.25rem; /* text-xl */
            font-weight: 700; /* font-bold */
        }
        
        #wizard-progress-bar {
            height: 0.5rem; /* h-2 */
        }
        
        #wizard-nav {
            position: sticky;
            bottom: 0;
            background-color: rgba(255, 255, 255, 0.9);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            padding: 1rem 1.5rem;
            border-top: 1px solid #e5e7eb;
            margin: 0 -1.5rem -1.5rem; /* Ajuste para preencher a largura do padding do container */
            border-bottom-left-radius: 0.5rem;
            border-bottom-right-radius: 0.5rem;
        }

        .resume-preview {
            width: 794px;
            min-height: 1123px;
            background-color: white;
            transition: all 0.3s ease-in-out;
            transform-origin: top left;
        }
        
        @media print {
            .form-container, .export-button-container { display: none; }
            .resume-preview { box-shadow: none; margin: 0; padding: 0; width: 100%; min-height: auto; }
            body { margin: 0; padding: 0; }
        }

        /* --- ESTILOS GERAIS PARA TÍTULOS DE SECÇÃO --- */
        .section-title {
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            padding-bottom: 0.5rem;
            margin-bottom: 1rem;
            border-bottom-width: 1px;
        }
        
        /* --- TEMPLATE CLÁSSICO (Padrão) --- */
        .template-classic { padding: 50px 75px; }
        .template-classic header { text-align: center; border-bottom: 1px solid #e5e7eb; padding-bottom: 1.5rem; }
        .template-classic #resume-name { color: var(--theme-color); }
        .template-classic .section-title { font-size: 1.25rem; color: var(--theme-color); border-color: #d1d5db; }
        
        /* --- TEMPLATE MODERNO --- */
        .template-modern { padding: 0; }
        .template-modern header { background-color: var(--theme-color); color: white; text-align: left; padding: 40px 50px; border-bottom: none; }
        .template-modern #resume-name { color: white; font-size: 2.5rem; }
        .template-modern #resume-job-title { color: #e0e7ff; }
        .template-modern #contact-info a, .template-modern #contact-info div { color: #c7d2fe; }
        .template-modern main { padding: 40px 50px; }
        .template-modern .section-title { color: var(--theme-color); border-color: #d1d5db; }

        /* --- TEMPLATE MINIMALISTA --- */
        .template-minimalist { padding: 50px 75px; font-family: 'Lato', sans-serif; }
        .template-minimalist header { text-align: left; border-bottom: 2px solid #111827; padding-bottom: 1rem; }
        .template-minimalist #resume-name { color: #111827; font-weight: 700; text-transform: uppercase; letter-spacing: 2px; font-size: 2rem; }
        .template-minimalist #resume-job-title { font-weight: 400; color: #6B7280; margin-top: 0.25rem; }
        .template-minimalist #contact-info { justify-content: flex-start; margin-top: 0.75rem; }
        .template-minimalist main { margin-top: 2rem; }
        .template-minimalist .section-title { font-size: 1rem; font-weight: 700; color: #111827; border: none; margin-bottom: 0.75rem; }
        .template-minimalist section { padding-bottom: 1rem; border-bottom: 1px solid #e5e7eb; }
        .template-minimalist section:last-child { border-bottom: none; }

        .gradient-text {
            background: var(--gradiente-texto);
            -webkit-background-clip: text;
            background-clip: text;
            color: transparent;
        }

        #resume-skills {
            /* O display: flex foi removido. As pílulas (inline-block) agora irão fluir naturalmente. */
        }

        #view-mode-wrapper {
            padding: 2rem;
            background-color: #f3f4f6; /* bg-gray-100 */
            min-height: 100vh;
        }

        .glass-effect {
            /* Opacidade aumentada para um azul mais forte */
            background: rgba(0, 46, 158, 0.45);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }

        .gradient-bg {
            background: linear-gradient(135deg, #002e9e, #0078e8);
        }

        .btn-primary {
            background: linear-gradient(135deg, #002e9e, #0078e8);
            transition: all 0.3s ease;
        }
        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 120, 232, 0.3);
        }

        .footer-logo {
            width: 130px; 
            height: auto;
        }
        .footer-social-icon {
            transition: all 0.3s ease;
        }
        .footer-social-icon:hover {
            background-color: rgba(255, 255, 255, 0.4) !important;
            transform: scale(1.1);
        }

    </style>
</head>

<body class="bg-gray-100 text-gray-800">

    <div id="main-content-wrapper">
        <header class="fixed top-6 left-6 right-6 bg-blue-800/80 backdrop-blur-lg z-50 border border-white/10 rounded-full shadow-lg">
            <div class="px-6 py-3 flex justify-between items-center">
                <a href="#" class="flex items-center">
                    <img src="https://i.postimg.cc/yNWrvPQJ/Subcabe-alho-76.png" alt="Vel Sites Logo" class="h-5 mr-3">
                </a>
                <nav>
                    <a href="#" class="text-white hover:text-blue-200 font-medium transition">Início</a>
                </nav>
            </div>
        </header>

        <div class="container mx-auto p-4 lg-p-8" style="padding-top: 9rem;">
            <div class="text-center mb-8">
                <h1 class="text-4xl font-bold gradient-text">Gerador de Currículo Gratuito</h1>
                <p class="text-lg text-gray-600 mt-2">Crie um currículo profissional e moderno em minutos.</p>
            </div>

            <div class="my-8 flex justify-center">
                <img src="https://files.catbox.moe/aid7gz.png" alt="Visualização dos modelos de currículo" class="max-w-full md:max-w-md rounded-lg">
            </div>

            <div class="fixed bottom-4 right-4 z-20 export-button-container">
                <button id="export-pdf" class="btn-primary text-white font-bold py-3 px-6 rounded-full shadow-lg transition-all duration-300 flex items-center gap-2 disabled:opacity-50 disabled:cursor-not-allowed disabled:shadow-none" disabled>
                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/><polyline points="7 10 12 15 17 10"/><line x1="12" y1="15" x2="12" y2="3"/></svg>
                    Exportar para PDF
                </button>
            </div>

            <div class="flex flex-col lg:flex-row gap-8">
                <!-- Coluna do Formulário --><div class="w-full lg:w-1/3 bg-white p-6 rounded-lg shadow-md form-container">
                    <div id="wizard-header" class="mb-4 text-center">
                        <p id="wizard-step-info" class="text-sm font-medium text-gray-500 mb-1"></p>
                        <h3 id="wizard-step-title" class="gradient-text"></h3>
                        <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                            <div id="wizard-progress-bar" class="btn-primary h-2 rounded-full transition-all duration-300" style="width: 0%"></div>
                        </div>
                    </div>

                    <form id="resume-form" class="space-y-6 flex-grow">
                        <div id="wizard-steps-container">
                        <!-- Estilo do Currículo --><fieldset class="border-0 p-4">
                            <legend class="text-lg font-semibold px-2 mb-4">Estilo e Design</legend>
                            <div>
                                <label class="block text-sm font-medium text-gray-700 mb-2">Selecione o Template</label>
                                <div id="template-selector" class="flex flex-col gap-3">
                                    <div class="template-option cursor-pointer border-2 border-blue-600 rounded-lg p-2 flex items-center gap-4" data-template="template-classic">
                                        <svg viewBox="0 0 100 140" class="w-16 h-auto rounded-md pointer-events-none bg-gray-100 p-1 border">
                                            <rect x="10" y="10" width="80" height="15" rx="3" fill="#cbd5e1"></rect>
                                            <rect x="10" y="35" width="80" height="5" rx="2" fill="#e2e8f0"></rect>
                                            <rect x="10" y="45" width="60" height="5" rx="2" fill="#e2e8f0"></rect>
                                            <rect x="10" y="65" width="80" height="8" rx="3" fill="#cbd5e1"></rect>
                                            <rect x="10" y="80" width="70" height="5" rx="2" fill="#e2e8f0"></rect>
                                            <rect x="10" y="90" width="80" height="5" rx="2" fill="#e2e8f0"></rect>
                                            <rect x="10" y="100" width="50" height="5" rx="2" fill="#e2e8f0"></rect>
                                        </svg>
                                        <span class="font-semibold text-sm">Clássico</span>
                                    </div>
                                    <div class="template-option cursor-pointer border-2 border-gray-300 rounded-lg p-2 flex items-center gap-4" data-template="template-modern">
                                        <svg viewBox="0 0 100 140" class="w-16 h-auto rounded-md pointer-events-none bg-gray-100 p-1 border">
                                            <rect x="10" y="10" width="25" height="120" rx="3" fill="#cbd5e1"></rect>
                                            <rect x="45" y="10" width="45" height="15" rx="3" fill="#cbd5e1"></rect>
                                            <rect x="45" y="35" width="45" height="5" rx="2" fill="#e2e8f0"></rect>
                                            <rect x="45" y="45" width="35" height="5" rx="2" fill="#e2e8f0"></rect>
                                            <rect x="45" y="65" width="45" height="8" rx="3" fill="#cbd5e1"></rect>
                                            <rect x="45" y="80" width="40" height="5" rx="2" fill="#e2e8f0"></rect>
                                        </svg>
                                        <span class="font-semibold text-sm">Moderno</span>
                                    </div>
                                    <div class="template-option cursor-pointer border-2 border-gray-300 rounded-lg p-2 flex items-center gap-4" data-template="template-minimalist">
                                        <svg viewBox="0 0 100 140" class="w-16 h-auto rounded-md pointer-events-none bg-gray-100 p-1 border">
                                            <rect x="10" y="10" width="80" height="10" rx="3" fill="#cbd5e1"></rect>
                                            <rect x="10" y="30" width="40" height="5" rx="2" fill="#e2e8f0"></rect>
                                            <line x1="10" y1="50" x2="90" y2="50" stroke="#e2e8f0" stroke-width="2"></line>
                                            <rect x="10" y="65" width="80" height="8" rx="3" fill="#cbd5e1"></rect>
                                            <rect x="10" y="80" width="70" height="5" rx="2" fill="#e2e8f0"></rect>
                                        </svg>
                                        <span class="font-semibold text-sm">Minimalista</span>
                                    </div>
                                </div>
                            </div>
                            <div class="mt-4">
                                <label class="block text-sm font-medium text-gray-700 mb-2">Escolha uma Cor de Destaque</label>
                                <div id="color-palette" class="flex gap-3">
                                    <div class="color-option w-8 h-8 rounded-full cursor-pointer border-4 border-blue-600" style="background-color: #002e9e;" data-color="#002e9e"></div>
                                    <div class="color-option w-8 h-8 rounded-full cursor-pointer border-4 border-white" style="background-color: #0078e8;" data-color="#0078e8"></div>
                                    <div class="color-option w-8 h-8 rounded-full cursor-pointer border-4 border-white" style="background-color: #374151;" data-color="#374151"></div>
                                    <div class="color-option w-8 h-8 rounded-full cursor-pointer border-4 border-white" style="background-color: #065f46;" data-color="#065f46"></div>
                                </div>
                            </div>
                        </fieldset>


                        <!-- Informações Pessoais --><fieldset class="border-0 p-4">
                            <legend class="text-lg font-semibold px-2 mb-4">Informações Pessoais</legend>
                            <div class="space-y-4">
                                <input type="text" id="name" placeholder="Nome Completo" class="w-full p-2 border rounded-md" data-target="resume-name">
                                <input type="text" id="job-title" placeholder="Cargo Desejado" class="w-full p-2 border rounded-md" data-target="resume-job-title">
                                <input type="email" id="email" placeholder="E-mail" class="w-full p-2 border rounded-md" data-target="resume-email">
                                <input type="tel" id="phone" placeholder="Telefone" class="w-full p-2 border rounded-md" data-target="resume-phone">
                                <input type="text" id="address" placeholder="Endereço (Ex: Cidade, Estado)" class="w-full p-2 border rounded-md" data-target="resume-address">
                                <input type="url" id="linkedin" placeholder="URL do LinkedIn" class="w-full p-2 border rounded-md" data-target="resume-linkedin">
                            </div>
                        </fieldset>

                        <!-- Resumo Profissional --><fieldset class="border-0 p-4">
                            <legend class="text-lg font-semibold px-2 mb-4">Resumo Profissional</legend>
                            <div class="relative">
                                <textarea id="summary" placeholder="Fale sobre sua carreira, objetivos e qualificações..." class="w-full p-2 border rounded-md h-32 pr-10" data-target="resume-summary"></textarea>
                                <button type="button" id="enhance-summary" title="Melhorar com IA" class="absolute top-2 right-2 text-indigo-500 hover:text-indigo-700 p-1 rounded-full hover:bg-indigo-100 transition-colors">
                                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sparkles"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M19 17v4"/><path d="M3 5h4"/><path d="M17 19h4"/></svg>
                                </button>
                            </div>
                        </fieldset>

                        <!-- Experiência Profissional --><fieldset class="border-0 p-4">
                            <legend class="text-lg font-semibold px-2 mb-4">Experiência Profissional</legend>
                            <div id="experience-list" class="space-y-4"></div>
                            <button type="button" id="add-experience" class="mt-4 bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-full hover:bg-gray-300 w-full">Adicionar Experiência</button>
                        </fieldset>

                        <!-- Formação Acadêmica --><fieldset class="border-0 p-4">
                            <legend class="text-lg font-semibold px-2 mb-4">Formação Acadêmica</legend>
                            <div id="education-list" class="space-y-4"></div>
                            <button type="button" id="add-education" class="mt-4 bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-full hover:bg-gray-300 w-full">Adicionar Formação</button>
                        </fieldset>

                        <!-- Habilidades --><fieldset class="border-0 p-4">
                            <legend class="text-lg font-semibold px-2 mb-4">Habilidades</legend>
                            <input type="text" id="skills" placeholder="Ex: HTML, CSS, Liderança" class="w-full p-2 border rounded-md" data-target="resume-skills">
                            <p class="text-xs text-gray-500 mt-1">Separe as habilidades por vírgula.</p>
                        </fieldset>
                        </div>
                    </form>
                    <div id="wizard-nav" class="mt-auto flex justify-between">
                        <button type="button" id="prev-step-button" class="bg-gray-200 text-gray-800 font-semibold py-2 px-4 rounded-full hover:bg-gray-300 disabled:opacity-50 disabled:cursor-not-allowed">Anterior</button>
                        <button type="button" id="next-step-button" class="btn-primary text-white font-semibold py-2 px-4 rounded-full">Próximo</button>
                    </div>
                </div>

                <!-- Coluna da Visualização --><div class="w-full lg:w-2/3">
                    <div id="preview-wrapper" class="w-full overflow-hidden rounded-lg shadow-md">
                        <div id="resume-preview" class="resume-preview bg-white text-gray-900 template-classic">
                            <!-- Cabeçalho --><header class="pb-6">
                                <h1 id="resume-name" class="text-4xl font-bold">Seu Nome</h1>
                                <h2 id="resume-job-title" class="text-xl font-medium text-gray-600 mt-1">Seu Cargo</h2>
                            <div id="contact-info" class="flex justify-center items-center gap-x-4 gap-y-2 mt-4 text-sm flex-wrap">
                                <a href="#" id="resume-email-container" class="text-gray-700 hover:text-blue-600 transition-colors"><span id="resume-email"></span></a>
                                <a href="#" id="resume-phone-container" class="text-gray-700 hover:text-blue-600 transition-colors"><span id="resume-phone"></span></a>
                                <div id="resume-address-container" class="text-gray-700"><span id="resume-address"></span></div>
                                <a href="#" id="resume-linkedin-container" target="_blank" class="text-gray-700 hover:text-blue-600 transition-colors"><span id="resume-linkedin"></span></a>
                            </div>
                        </header>

                        <main class="mt-8 space-y-8">
                            <section id="summary-section">
                                <h3 class="section-title">Resumo Profissional</h3>
                                <p id="resume-summary" class="text-gray-700 leading-relaxed"></p>
                            </section>
                            <section id="experience-section">
                                <h3 class="section-title">Experiência Profissional</h3>
                                <div id="resume-experience-list" class="space-y-6"></div>
                            </section>
                            <section id="education-section">
                                <h3 class="section-title">Formação Acadêmica</h3>
                                <div id="resume-education-list" class="space-y-4"></div>
                            </section>
                            <section id="skills-section">
                                <h3 class="section-title">Habilidades</h3>
                                <div id="resume-skills"></div>
                            </section>
                        </main>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="view-mode-wrapper" class="hidden">
        <!-- O preview do currículo será movido para aqui no modo de visualização --></div>

    <footer class="bg-gray-900 text-white py-10 md:py-12">
        <div class="container mx-auto px-4 max-w-7xl">
            <div class="flex flex-col md:flex-row justify-between items-center">
                <div class="mb-6 md:mb-0 text-center md:text-left">
                    <div class="mb-4 mx-auto md:mx-0" style="width: fit-content;">
                        <img src="https://i.postimg.cc/D0pp6j3q/Subcabe-alho-39.png" alt="Vel Sites Logo Rodapé" class="footer-logo">
                    </div>
                    <p class="text-gray-400 max-w-md">A Vel nasceu pra quem não espera, pra quem resolve. Se você move o mundo com seu ofício, a gente move sua marca no digital.</p>
                </div>
                <div class="flex flex-col md:flex-row space-y-6 md:space-y-0 md:space-x-12 text-center md:text-left">
                    <div>
                        <h4 class="font-bold text-lg mb-4">Contacto</h4>
                        <ul class="space-y-2">
                            <li class="text-gray-400">(37) 98416-9386</li>
                            <li class="text-gray-400">contato@velsites.com.br</li>
                        </ul>
                    </div>
                     <div>
                        <h4 class="font-bold text-lg mb-4">Siga-nos</h4>
                        <div class="flex space-x-4 justify-center md:justify-start">
                            <a href="https://www.instagram.com/velsites.com.br/" target="_blank" class="w-10 h-10 rounded-full bg-white/20 flex items-center justify-center footer-social-icon"><svg class="w-5 h-5 text-white" fill="currentColor" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M12.315 2c2.43 0 2.784.013 3.808.06 1.064.049 1.791.218 2.427.465a4.902 4.902 0 011.772 1.153 4.902 4.902 0 011.153 1.772c.247.636.416 1.363.465 2.427.048 1.067.06 1.407.06 4.123v.08c0 2.643-.012 2.987-.06 4.043-.049 1.064-.218 1.791-.465 2.427a4.902 4.902 0 01-1.153 1.772 4.902 4.902 0 01-1.772 1.153c-.636.247-1.363.416-2.427.465-1.067.048-1.407.06-4.123.06h-.08c-2.643 0-2.987-.012-4.043-.06-1.064-.049-1.791-.218-2.427-.465a4.902 4.902 0 01-1.772-1.153 4.902 4.902 0 01-1.153-1.772c-.247-.636-.416-1.363-.465-2.427-.047-1.024-.06-1.379-.06-3.808v-.63c0-2.43.013-2.784.06-3.808.049-1.064.218-1.791.465-2.427a4.902 4.902 0 011.153-1.772A4.902 4.902 0 015.45 2.525c.636-.247 1.363-.416 2.427-.465C8.901 2.013 9.256 2 11.685 2h.63zm-.081 1.802h-.468c-2.456 0-2.784.011-3.807.058-.975.045-1.504.207-1.857.344-.467.182-.8.398-1.15.748-.35.35-.566.683-.748 1.15-.137.353-.3.882-.344 1.857-.047 1.023-.058 1.351-.058 3.807v.468c0 2.456.011 2.784.058 3.807.045.975.207 1.504.344 1.857.182.466.399.8.748 1.15.35.35.683.566 1.15.748.353.137.882.3 1.857.344 1.054.048 1.37.058 4.041.058h.08c2.597 0 2.917-.01 3.96-.058.976-.045 1.505-.207 1.858-.344.466-.182.8-.398 1.15-.748.35-.35.566-.683.748-1.15.137-.353-.3-.882.344-1.857.048-1.055.058-1.37.058-4.041v-.08c0-2.597-.01-2.917-.058-3.96-.045-.976-.207-1.505-.344-1.858a3.097 3.097 0 00-.748-1.15 3.098 3.098 0 00-1.15-.748c-.353-.137-.882-.3-1.857-.344-1.023-.047-1.351-.058-3.807-.058zM12 6.865a5.135 5.135 0 110 10.27 5.135 5.135 0 010-10.27zm0 1.802a3.333 3.333 0 100 6.666 3.333 3.333 0 000-6.666zm5.338-3.205a1.2 1.2 0 110 2.4 1.2 1.2 0 010-2.4z" clip-rule="evenodd"></path></svg></a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="border-t border-gray-800 mt-10 pt-6 text-center text-gray-400">
                <p>&copy; 2025 Vel Sites. Todos os direitos reservados. Site criado por Vel Sites - Criador de Site em Nova Serrana.</p>
            </div>
        </div>
    </footer>


    <script type="module">
        document.addEventListener('DOMContentLoaded', async () => {
            // SOLUÇÃO DEFINITIVA: Espera que todas as fontes da página (incluindo 'Poppins')
            // estejam completamente carregadas antes de executar qualquer outro código.
            // Isto garante que o html2canvas sempre "verá" o texto com a fonte correta.
            await document.fonts.ready;

            const form = document.getElementById('resume-form');
            const resumePreview = document.getElementById('resume-preview');
            const templateSelector = document.getElementById('template-selector');
            const colorPalette = document.getElementById('color-palette');

            let wizardSteps = [];
            let currentStep = 0;
            const prevStepButton = document.getElementById('prev-step-button');
            const nextStepButton = document.getElementById('next-step-button');
            const stepInfo = document.getElementById('wizard-step-info');
            const stepTitle = document.getElementById('wizard-step-title');
            const progressBar = document.getElementById('wizard-progress-bar');
            const stepsContainer = document.getElementById('wizard-steps-container');
            
            const exportPdfButton = document.getElementById('export-pdf');

            // --- LÓGICA DE ESCALA DA PRÉ-VISUALIZAÇÃO ---
            const previewWrapper = document.getElementById('preview-wrapper');
            
            function scalePreview() {
                if (!previewWrapper || !resumePreview) return;
                
                const wrapperWidth = previewWrapper.offsetWidth;
                const baseWidth = 794; // Largura base A4 em px
                const baseHeight = 1123; // Altura base A4 em px
                
                const scale = wrapperWidth / baseWidth;
                
                resumePreview.style.transform = `scale(${scale})`;
                previewWrapper.style.height = `${baseHeight * scale}px`;
            }

            // Ligar a função
            window.addEventListener('resize', scalePreview);
            // Um pequeno atraso para garantir que o layout está estável
            setTimeout(scalePreview, 100);

            // --- WIZARD LOGIC ---
            function initWizard() {
                wizardSteps = Array.from(form.querySelectorAll('fieldset'));
                // Arredonda todos os inputs e textareas do formulário dinamicamente
                form.querySelectorAll('input, textarea').forEach(el => el.classList.add('rounded-lg'));
                showStep(0);
            }

            function showStep(stepIndex) {
                if (stepIndex < 0 || stepIndex >= wizardSteps.length) return;

                const nextStepElement = wizardSteps[stepIndex];

                // Ajusta a altura do container para a altura do próximo passo, criando uma transição suave
                if (nextStepElement) {
                    stepsContainer.style.height = `${nextStepElement.scrollHeight}px`;
                }

                wizardSteps.forEach((step, index) => {
                    step.classList.toggle('step-active', index === stepIndex);
                });

                currentStep = stepIndex;
                updateWizardControls();
            }

            function updateWizardControls() {
                const topic = wizardSteps[currentStep].querySelector('legend').textContent;
                stepInfo.textContent = `Passo ${currentStep + 1} de ${wizardSteps.length}`;
                stepTitle.textContent = topic;
                progressBar.style.width = `${((currentStep + 1) / wizardSteps.length) * 100}%`;
                prevStepButton.disabled = currentStep === 0;
                nextStepButton.textContent = currentStep === wizardSteps.length - 1 ? 'Concluir' : 'Próximo';
            }

            prevStepButton.addEventListener('click', () => { if (currentStep > 0) showStep(currentStep - 1); });
            nextStepButton.addEventListener('click', () => {
                if (currentStep < wizardSteps.length - 1) {
                    showStep(currentStep + 1);
                } else {
                    // Clicou em "Concluir" na última etapa
                    exportPdfButton.disabled = false;
                }
            });
            initWizard();


            // --- LÓGICA DE ESTILO E TEMPLATE ---
            templateSelector.addEventListener('click', (e) => {
                const selectedOption = e.target.closest('.template-option');
                if (!selectedOption) return;

                document.querySelectorAll('.template-option').forEach(opt => opt.classList.replace('border-blue-600', 'border-gray-300'));
                selectedOption.classList.replace('border-gray-300', 'border-blue-600');

                const template = selectedOption.dataset.template;
                resumePreview.className = resumePreview.className.replace(/template-\w+/g, '');
                resumePreview.classList.add(template);
                
                reorganizeModernTemplate(template);
            });
            
            colorPalette.addEventListener('click', (e) => {
                const selectedColor = e.target.closest('.color-option');
                if (!selectedColor) return;

                document.querySelectorAll('.color-option').forEach(opt => opt.classList.replace('border-blue-600', 'border-white'));
                selectedColor.classList.replace('border-white', 'border-blue-600');
                
                document.documentElement.style.setProperty('--theme-color', selectedColor.dataset.color);
            });

            function reorganizeModernTemplate(template) {
                const main = resumePreview.querySelector('main');
                const summarySection = document.getElementById('summary-section');
                const experienceSection = document.getElementById('experience-section');
                const educationSection = document.getElementById('education-section');
                const skillsSection = document.getElementById('skills-section');

                // Se não for o template moderno, e a estrutura de grid existir, desfazemo-la.
                if (template !== 'template-modern') {
                    if (main.querySelector('.sidebar-content')) {
                        // Move as secções de volta para o main na ordem correta
                        main.appendChild(summarySection);
                        main.appendChild(experienceSection);
                        main.appendChild(educationSection);
                        main.appendChild(skillsSection);
                        // Limpa os contentores da grelha que já não são necessários
                        main.querySelector('.sidebar-content').remove();
                        main.querySelector('.main-content').remove();
                    }
                    return;
                }
                
                // Para o template moderno, já no criamos uma grelha. A estrutura vertical padrão é utilizada.
            }

            function clearForm() {
                form.reset();
                document.getElementById('experience-list').innerHTML = '';
                document.getElementById('education-list').innerHTML = '';
                form.querySelectorAll('input, textarea').forEach(input => input.dispatchEvent(new Event('input', { bubbles: true })));
                updateDynamicSections();
                showStep(0);
                exportPdfButton.disabled = true;
            }

            // --- ATUALIZAÇÃO EM TEMPO REAL ---
            form.addEventListener('input', (e) => {
                const input = e.target;
                const value = input.value;
                const targetId = input.dataset.target;

                if (!targetId) return;
                const targetElement = document.getElementById(targetId);
                if (!targetElement) return;

                switch (targetId) {
                    case 'resume-name':
                    case 'resume-job-title':
                    case 'resume-summary':
                        targetElement.textContent = value || '';
                        break;
                    
                    case 'resume-email':
                    case 'resume-phone':
                    case 'resume-address':
                    case 'resume-linkedin':
                        const container = document.getElementById(`${targetId}-container`);
                        container.style.display = value ? 'inline-flex' : 'none';
                        targetElement.textContent = value;
                        if (targetId === 'resume-linkedin') {
                            container.href = value.startsWith('http') ? value : `https://` + value;
                            targetElement.textContent = value.replace(/(^\w+:|^)\/\//, '');
                        } else if (targetId === 'resume-email') { container.href = `mailto:${value}`; 
                        } else if (targetId === 'resume-phone') { container.href = `tel:${value}`; }
                        break;

                    case 'resume-skills':
                        targetElement.innerHTML = ''; // Limpa as habilidades existentes
                        const skillsArray = value.split(',').map(skill => skill.trim()).filter(skill => skill);
                        skillsArray.forEach(skillText => {
                            const pill = document.createElement('span');
                            pill.textContent = skillText;
                            // Solução robusta: Usar 'inline-block' com margens em vez de flexbox 'gap'.
                            // Esta é a abordagem mais compatível para a renderização do PDF.
                            pill.className = 'inline-block bg-gray-200 rounded-full px-3 py-1 text-sm font-semibold text-gray-700 mr-2 mb-2';
                            targetElement.appendChild(pill);
                        });
                        break;
                }
            });

            ['email', 'phone', 'address', 'linkedin'].forEach(field => {
                 document.getElementById(`resume-${field}-container`).style.display = 'none';
            });
            
            
            // --- SEÇÕES DINÂMICAS (EXPERIÊNCIA E EDUCAÇÃO) ---
            let experienceCount = 0;
            let educationCount = 0;

            const addExperience = () => {
                experienceCount++;
                const list = document.getElementById('experience-list');
                const newItem = document.createElement('div');
                newItem.className = 'border p-4 rounded-md space-y-2 relative';
                newItem.dataset.id = experienceCount;
                newItem.innerHTML = `
                    <button type="button" class="absolute top-2 right-2 text-red-500 hover:text-red-700 font-bold" onclick="removeSection('experience', ${experienceCount})">&times;</button>
                    <input type="text" placeholder="Cargo" class="w-full p-2 border rounded-md experience-job-title">
                    <input type="text" placeholder="Empresa" class="w-full p-2 border rounded-md experience-company">
                    <input type="text" placeholder="Local (Ex: São Paulo, SP)" class="w-full p-2 border rounded-md experience-location">
                    <div class="flex gap-2">
                        <input type="text" placeholder="Início (Ex: Jan 2020)" class="w-1/2 p-2 border rounded-md experience-start-date">
                        <input type="text" placeholder="Fim (Ex: Atual)" class="w-1/2 p-2 border rounded-md experience-end-date">
                    </div>
                    <div class="relative">
                        <textarea placeholder="Principais responsabilidades e conquistas..." class="w-full p-2 border rounded-md h-24 experience-description pr-10"></textarea>
                        <button type="button" title="Melhorar com IA" class="enhance-experience absolute top-2 right-2 text-indigo-500 hover:text-indigo-700 p-1 rounded-full hover:bg-indigo-100 transition-colors">
                             <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-sparkles"><path d="m12 3-1.912 5.813a2 2 0 0 1-1.275 1.275L3 12l5.813 1.912a2 2 0 0 1 1.275 1.275L12 21l1.912-5.813a2 2 0 0 1 1.275-1.275L21 12l-5.813-1.912a2 2 0 0 1-1.275-1.275L12 3Z"/><path d="M5 3v4"/><path d="M19 17v4"/><path d="M3 5h4"/><path d="M17 19h4"/></svg>
                        </button>
                    </div>
                `;
                list.appendChild(newItem);
            };

            const addEducation = () => {
                educationCount++;
                const list = document.getElementById('education-list');
                const newItem = document.createElement('div');
                newItem.className = 'border p-4 rounded-md space-y-2 relative';
                newItem.dataset.id = educationCount;
                newItem.innerHTML = `
                    <button type="button" class="absolute top-2 right-2 text-red-500 hover:text-red-700 font-bold" onclick="removeSection('education', ${educationCount})">&times;</button>
                    <input type="text" placeholder="Curso/Formação (Ex: Bacharelado)" class="w-full p-2 border rounded-md education-degree">
                    <input type="text" placeholder="Instituição de Ensino" class="w-full p-2 border rounded-md education-institution">
                    <div class="flex gap-2">
                         <input type="text" placeholder="Início (Ex: 2016)" class="w-1/2 p-2 border rounded-md education-start-date">
                         <input type="text" placeholder="Fim (Ex: 2020)" class="w-1/2 p-2 border rounded-md education-end-date">
                    </div>
                `;
                list.appendChild(newItem);
            };
            
            window.removeSection = (type, id) => {
                document.querySelector(`#${type}-list > div[data-id="${id}"]`)?.remove();
                updateDynamicSections();
            };

            const updateDynamicSections = () => {
                const experienceResumeList = document.getElementById('resume-experience-list');
                if (experienceResumeList) {
                    experienceResumeList.innerHTML = '';
                    document.querySelectorAll('#experience-list > div').forEach(item => {
                        const jobTitle = item.querySelector('.experience-job-title').value;
                        const company = item.querySelector('.experience-company').value;
                        const location = item.querySelector('.experience-location').value;
                        const startDate = item.querySelector('.experience-start-date').value;
                        const endDate = item.querySelector('.experience-end-date').value;
                        const description = item.querySelector('.experience-description').value.replace(/\n/g, '<br>');

                        if (jobTitle || company) {
                            experienceResumeList.innerHTML += `
                                <div>
                                    <div class="flex justify-between items-baseline flex-wrap">
                                        <div class="pr-4">
                                            <h4 class="text-lg font-semibold">${jobTitle || ''}</h4>
                                            <p class="text-md text-gray-700">${company || ''} ${location ? `&bull; ${location}` : ''}</p>
                                        </div>
                                        <p class="text-sm text-gray-500 text-right whitespace-nowrap">${startDate || ''} ${startDate && endDate ? ' - ' : ''} ${endDate || ''}</p>
                                    </div>
                                    <p class="mt-2 text-gray-600 leading-relaxed">${description || ''}</p>
                                </div>
                            `;
                        }
                    });
                }

                const educationResumeList = document.getElementById('resume-education-list');
                if (educationResumeList) {
                    educationResumeList.innerHTML = '';
                    document.querySelectorAll('#education-list > div').forEach(item => {
                        const degree = item.querySelector('.education-degree').value;
                        const institution = item.querySelector('.education-institution').value;
                        const startDate = item.querySelector('.education-start-date').value;
                        const endDate = item.querySelector('.education-end-date').value;
                        
                        if(degree || institution) {
                            educationResumeList.innerHTML += `
                                <div>
                                    <div class="flex justify-between items-baseline flex-wrap">
                                        <div class="pr-4">
                                            <h4 class="text-lg font-semibold">${degree || ''}</h4>
                                            <p class="text-md text-gray-700">${institution || ''}</p>
                                        </div>
                                        <p class="text-sm text-gray-500 text-right whitespace-nowrap">${startDate || ''} ${startDate && endDate ? ' - ' : ''} ${endDate || ''}</p>
                                    </div>
                                </div>
                            `;
                        }
                    });
                }
            };

            document.getElementById('add-experience').addEventListener('click', addExperience);
            document.getElementById('add-education').addEventListener('click', addEducation);
            form.addEventListener('input', (e) => {
                if(e.target.closest('#experience-list') || e.target.closest('#education-list')) {
                    updateDynamicSections();
                }
            });

            // --- LÓGICA DA IA (GEMINI) ---
            const apiKey = "";
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;
            const spinnerIcon = `<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-indigo-500" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>`;

            async function callGeminiAPI(prompt, button) {
                const originalButtonContent = button.innerHTML;
                button.disabled = true;
                button.innerHTML = spinnerIcon;

                try {
                    const payload = {
                        contents: [{ parts: [{ text: prompt }] }],
                        systemInstruction: { parts: [{ text: "Você é um especialista em RH que cria currículos. Sua tarefa é reescrever o texto fornecido para ser mais profissional e impactante. Responda apenas com o texto reescrito, sem introduções ou comentários." }] },
                    };
                    const response = await fetch(apiUrl, { method: 'POST', headers: { 'Content-Type': 'application/json' }, body: JSON.stringify(payload) });
                    if (!response.ok) throw new Error(`API error: ${response.statusText}`);
                    const result = await response.json();
                    const generatedText = result.candidates?.[0]?.content?.parts?.[0]?.text;
                    if (!generatedText) throw new Error("A IA não conseguiu gerar uma sugestão.");
                    return generatedText.trim();
                } catch (error) {
                    console.error("Erro ao chamar a API Gemini:", error);
                    return null;
                } finally {
                    button.disabled = false;
                    button.innerHTML = originalButtonContent;
                }
            }

            document.getElementById('enhance-summary').addEventListener('click', async (e) => {
                const button = e.currentTarget;
                const textarea = document.getElementById('summary');
                const text = textarea.value;
                if (!text.trim()) return;
                const prompt = `Reescreva o seguinte resumo profissional para ser mais conciso e impactante, destacando as principais qualidades: "${text}"`;
                const enhancedText = await callGeminiAPI(prompt, button);
                if (enhancedText) {
                    textarea.value = enhancedText;
                    textarea.dispatchEvent(new Event('input', { bubbles: true }));
                }
            });

            document.getElementById('experience-list').addEventListener('click', async (e) => {
                const button = e.target.closest('.enhance-experience');
                if (!button) return;
                const formItem = button.closest('.border');
                const textarea = formItem.querySelector('.experience-description');
                const jobTitle = formItem.querySelector('.experience-job-title').value;
                const text = textarea.value;
                if (!text.trim()) return;
                const prompt = `Considerando o cargo de "${jobTitle}", reescreva a seguinte descrição de experiência profissional usando verbos de ação e focando em conquistas, de forma profissional e sucinta: "${text}"`;
                const enhancedText = await callGeminiAPI(prompt, button);
                if (enhancedText) {
                    textarea.value = enhancedText;
                    textarea.dispatchEvent(new Event('input', { bubbles: true }));
                }
            });

            // --- EXPORTAR PARA PDF ---
            document.getElementById('export-pdf').addEventListener('click', (e) => {
                const button = e.currentTarget;
                const originalContent = button.innerHTML;
                button.disabled = true;
                button.innerHTML = `<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>Gerando...`;
                
                // Temporariamente redefinir a escala para a exportação
                const originalTransform = resumePreview.style.transform;
                const originalWrapperHeight = previewWrapper.style.height;
                resumePreview.style.transform = 'scale(1)';
                previewWrapper.style.height = '1123px';

                const resumeName = document.getElementById('name').value.trim().replace(/ /g, '_') || 'curriculo';
                window.scrollTo(0, 0);

                setTimeout(() => {
                    html2canvas(resumePreview, { scale: 2, useCORS: true, logging: false }).then(canvas => {
                        const { jsPDF } = window.jspdf;
                        const imgData = canvas.toDataURL('image/png');
                        const pdf = new jsPDF({ orientation: 'portrait', unit: 'pt', format: 'a4' });
                        const pdfWidth = pdf.internal.pageSize.getWidth();
                        const canvasWidth = canvas.width;
                        const ratio = pdfWidth / canvasWidth;
                        const finalHeight = canvas.height * ratio;

                        pdf.addImage(imgData, 'PNG', 0, 0, pdfWidth, finalHeight);
                        pdf.save(`${resumeName}.pdf`);
                    }).finally(() => {
                        // Restaurar a escala e o estado do botão
                        resumePreview.style.transform = originalTransform;
                        previewWrapper.style.height = originalWrapperHeight;
                        button.disabled = false;
                        button.innerHTML = originalContent;
                    });
                }, 500); // 500ms para garantir que o DOM seja atualizado
            });
        });
    </script>
</body>
</html>



